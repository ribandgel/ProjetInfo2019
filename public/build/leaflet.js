(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["leaflet"],{

/***/ "./assets/js/leaflet.js":
/*!******************************!*\
  !*** ./assets/js/leaflet.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.map */ "./node_modules/core-js/modules/es.array.map.js");

__webpack_require__(/*! core-js/modules/es.function.name */ "./node_modules/core-js/modules/es.function.name.js");

var L = __webpack_require__(/*! leaflet */ "./node_modules/leaflet/dist/leaflet-src.js");

var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");

var c = __webpack_require__(/*! ../css/app.scss */ "./assets/css/app.scss"); //this fixes a leaflet bug that does not import the marker images if we don't add those lines


delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon-2x.png */ "./node_modules/leaflet/dist/images/marker-icon-2x.png"),
  iconUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon.png */ "./node_modules/leaflet/dist/images/marker-icon.png"),
  shadowUrl: __webpack_require__(/*! leaflet/dist/images/marker-shadow.png */ "./node_modules/leaflet/dist/images/marker-shadow.png")
});
var producers = [];
var producer = {};
var mymap;
var layerGroup;
var marker;
$(document).ready(function () {
  $.get("http://127.0.0.1:8000/api/producers", function (data) {
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      var _producer = {
        name: obj.name,
        lat: obj.latitude,
        "long": obj.longitude,
        website: obj.website
      };
      producers.push(_producer);
    }

    mymap = L.map('mapid', {
      minZoom: 5,
      maxZoom: 8
    }).setView([46.227638, 2.213749], 6);
    L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);
    layerGroup = L.layerGroup().addTo(mymap);

    for (var _i = 0; _i < producers.length; _i++) {
      marker = L.marker([producers[_i].lat, producers[_i]["long"]]).addTo(layerGroup);

      if (producers[_i].website != "") {
        marker.bindPopup("<a target=\"_blank\" href=" + producers[_i].website + "><b>Domaine</b><br>" + producers[_i].name + "</a>");
      } else {
        marker.bindPopup("<b>Domaine</b><br>" + producers[_i].name);
      }
    }
  });
  var searchDiv = document.getElementById("search");
  searchDiv.style.display = "none";
  var searchOpt = document.getElementById("searchOpt");
  searchOpt.addEventListener("click", function () {
    searchDiv.hidden = false;
  });
  var dropDwnContent = document.getElementById("dropdown-content");
  searchOpt.addEventListener("click", function () {
    searchDiv.style.display = "inline";
    searchOpt.style.display = "none";
    dropDwnContent.style.display = "none";
  });
  /*----------------------------STUFFS TO FILTER SEARCH ON MAP-------------------------------*/

  var searchBt = document.getElementById("searchBt"); //le boutton rechercher

  var radioOpt = document.getElementsByName('searchOption'); //le radio bt chosen by user to filter by

  var resNotDFound = document.getElementById('notFound');
  /*....controls the placeholder of the search bar when picking different filtering options from the radio buttons ....*/

  var prev = null;

  for (var i = 0; i < radioOpt.length; i++) {
    radioOpt[i].addEventListener('change', function () {
      //(prev) ? console.log(prev.value): null;
      if (this !== prev) {
        prev = this;
      }

      for (var _i2 = 0, length = radioOpt.length; _i2 < length; _i2++) {
        if (radioOpt[_i2].checked) {
          //console.log("radio checked = " + radioOpt[i].value);
          if (radioOpt[_i2].value === "appellation") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom d\'appellation';
          }

          if (radioOpt[_i2].value === "couleur") {
            document.getElementById("searchQuery").placeholder = 'Entrez une couleur';
          }

          if (radioOpt[_i2].value === "cepage") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom de cépage';
          }
        } //console.log(this.value)

      }
    });
  }
  /*.............................................................................................................*/


  searchBt.addEventListener("click", function () {
    layerGroup.clearLayers();
    var ps = [];
    var p = {};
    var search = document.getElementById("searchQuery").value; //ce qu'a ecrit l'utilisateur dans la barre de recherche

    var _loop = function _loop(_i3) {
      if (radioOpt[_i3].checked) {
        $.get("http://127.0.0.1:8000/api/wines", function (data) {
          if (radioOpt[_i3].value === "appellation") {
            for (var _i4 = 0; _i4 < data.length; _i4++) {
              var obj = data[_i4];
              console.log("DATA[i] = " + data[_i4]);
              var name = obj.designation.name;

              if (search == name) {
                p.name = obj.producer.name; //console.log("name found = " + p.name);

                p.lat = obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i5 = 0; _i5 < ps.length; _i5++) {
                  marker = L.marker([ps[_i5].lat, ps[_i5]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i5].name + "</a>");
                }
              }
            }

            if (ps.length == 0) {
              resNotDFound.innerText = "Pas de résultats.";
            }
          }

          if (radioOpt[_i3].value === "couleur") {
            for (var _i6 = 0; _i6 < data.length; _i6++) {
              var _obj = data[_i6];
              var color = _obj.color.color; //console.log("COLOR = " + color);

              if (search == color) {
                p.name = _obj.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i7 = 0; _i7 < ps.length; _i7++) {
                  marker = L.marker([ps[_i7].lat, ps[_i7]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i7].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "cepage") {
            for (var _i8 = 0; _i8 < data.length; _i8++) {
              var _obj2 = data[_i8];
              var variety = _obj2.variety.name;

              if (search == variety) {
                p.name = _obj2.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj2.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj2.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i9 = 0; _i9 < ps.length; _i9++) {
                  marker = L.marker([ps[_i9].lat, ps[_i9]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i9].name + "</a>");
                }
              }
            }
          }
        });
      }
    };

    for (var _i3 = 0; _i3 < radioOpt.length; _i3++) {
      _loop(_i3);
    }
  });
}); // The Leaflet L.Map class provides the fitBounds method to zoom a map to contain a rectangular bounding box.
// The L.latLngBounds utility function creates a bounding box object from an array of latitude and longitude coordinates.
// With a single marker, however, we only have one latitude and longitude coordinate from which to create the bounding box.
// The solution is to create a single-element array containing the latitude and longitude coordinate of the marker.
// The following function centers and zooms a leaflet map on a single marker. Line 2 creates the single-element array containing
// the latitude and longitude coordinate of the marker. Line 3 creates the bounding box that encloses the marker’s location. Finally,
// line 4 zooms the map to enclose the bounding box.
// function centerLeafletMapOnMarker(map, marker) {
//     var latLngs = [ marker.getLatLng() ];
//     var markerBounds = L.latLngBounds(latLngs);
//     map.fitBounds(markerBounds);
// }

/***/ })

},[["./assets/js/leaflet.js","runtime","vendors~leaflet","app~boostrap~leaflet"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvbGVhZmxldC5qcyJdLCJuYW1lcyI6WyJMIiwicmVxdWlyZSIsIiQiLCJjIiwiSWNvbiIsIkRlZmF1bHQiLCJwcm90b3R5cGUiLCJfZ2V0SWNvblVybCIsIm1lcmdlT3B0aW9ucyIsImljb25SZXRpbmFVcmwiLCJpY29uVXJsIiwic2hhZG93VXJsIiwicHJvZHVjZXJzIiwicHJvZHVjZXIiLCJteW1hcCIsImxheWVyR3JvdXAiLCJtYXJrZXIiLCJkb2N1bWVudCIsInJlYWR5IiwiZ2V0IiwiZGF0YSIsImkiLCJsZW5ndGgiLCJvYmoiLCJuYW1lIiwibGF0IiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJ3ZWJzaXRlIiwicHVzaCIsIm1hcCIsIm1pblpvb20iLCJtYXhab29tIiwic2V0VmlldyIsInRpbGVMYXllciIsImF0dHJpYnV0aW9uIiwiYWRkVG8iLCJiaW5kUG9wdXAiLCJzZWFyY2hEaXYiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiZGlzcGxheSIsInNlYXJjaE9wdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoaWRkZW4iLCJkcm9wRHduQ29udGVudCIsInNlYXJjaEJ0IiwicmFkaW9PcHQiLCJnZXRFbGVtZW50c0J5TmFtZSIsInJlc05vdERGb3VuZCIsInByZXYiLCJjaGVja2VkIiwidmFsdWUiLCJwbGFjZWhvbGRlciIsImNsZWFyTGF5ZXJzIiwicHMiLCJwIiwic2VhcmNoIiwiY29uc29sZSIsImxvZyIsImRlc2lnbmF0aW9uIiwiaW5uZXJUZXh0IiwiY29sb3IiLCJ2YXJpZXR5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBQyxHQUFDQyxtQkFBTyxDQUFDLDJEQUFELENBQWI7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFHRCxtQkFBTyxDQUFDLG9EQUFELENBQWY7O0FBQ0EsSUFBSUUsQ0FBQyxHQUFHRixtQkFBTyxDQUFDLDhDQUFELENBQWYsQyxDQUVBOzs7QUFDQSxPQUFPRCxDQUFDLENBQUNJLElBQUYsQ0FBT0MsT0FBUCxDQUFlQyxTQUFmLENBQXlCQyxXQUFoQztBQUNBUCxDQUFDLENBQUNJLElBQUYsQ0FBT0MsT0FBUCxDQUFlRyxZQUFmLENBQTRCO0FBQ3hCQyxlQUFhLEVBQUVSLG1CQUFPLENBQUMscUdBQUQsQ0FERTtBQUV4QlMsU0FBTyxFQUFFVCxtQkFBTyxDQUFDLCtGQUFELENBRlE7QUFHeEJVLFdBQVMsRUFBRVYsbUJBQU8sQ0FBQyxtR0FBRDtBQUhNLENBQTVCO0FBTUEsSUFBSVcsU0FBUyxHQUFHLEVBQWhCO0FBQ0EsSUFBSUMsUUFBUSxHQUFHLEVBQWY7QUFDQSxJQUFJQyxLQUFKO0FBQ0EsSUFBSUMsVUFBSjtBQUNBLElBQUlDLE1BQUo7QUFFQWQsQ0FBQyxDQUFDZSxRQUFELENBQUQsQ0FBWUMsS0FBWixDQUFrQixZQUFZO0FBQzFCaEIsR0FBQyxDQUFDaUIsR0FBRixDQUFNLHFDQUFOLEVBQTZDLFVBQVVDLElBQVYsRUFBZ0I7QUFDekQsU0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHRCxJQUFJLENBQUNFLE1BQXpCLEVBQWlDRCxDQUFDLEVBQWxDLEVBQXNDO0FBQ2xDLFVBQUlFLEdBQUcsR0FBR0gsSUFBSSxDQUFDQyxDQUFELENBQWQ7QUFDQSxVQUFJUixTQUFRLEdBQUc7QUFDWFcsWUFBSSxFQUFFRCxHQUFHLENBQUNDLElBREM7QUFFWEMsV0FBRyxFQUFFRixHQUFHLENBQUNHLFFBRkU7QUFHWCxnQkFBTUgsR0FBRyxDQUFDSSxTQUhDO0FBSVhDLGVBQU8sRUFBRUwsR0FBRyxDQUFDSztBQUpGLE9BQWY7QUFNQWhCLGVBQVMsQ0FBQ2lCLElBQVYsQ0FBZWhCLFNBQWY7QUFDSDs7QUFDREMsU0FBSyxHQUFHZCxDQUFDLENBQUM4QixHQUFGLENBQU0sT0FBTixFQUFlO0FBQUNDLGFBQU8sRUFBRSxDQUFWO0FBQWFDLGFBQU8sRUFBRTtBQUF0QixLQUFmLEVBQXlDQyxPQUF6QyxDQUFpRCxDQUFDLFNBQUQsRUFBWSxRQUFaLENBQWpELEVBQXdFLENBQXhFLENBQVI7QUFDQWpDLEtBQUMsQ0FBQ2tDLFNBQUYsQ0FBWSwrRUFBWixFQUE2RjtBQUN6RkYsYUFBTyxFQUFFLEVBRGdGO0FBRXpGRyxpQkFBVyxFQUFFO0FBRjRFLEtBQTdGLEVBR0dDLEtBSEgsQ0FHU3RCLEtBSFQ7QUFLQUMsY0FBVSxHQUFHZixDQUFDLENBQUNlLFVBQUYsR0FBZXFCLEtBQWYsQ0FBcUJ0QixLQUFyQixDQUFiOztBQUNBLFNBQUssSUFBSU8sRUFBQyxHQUFHLENBQWIsRUFBZ0JBLEVBQUMsR0FBR1QsU0FBUyxDQUFDVSxNQUE5QixFQUFzQ0QsRUFBQyxFQUF2QyxFQUEyQztBQUN2Q0wsWUFBTSxHQUFHaEIsQ0FBQyxDQUFDZ0IsTUFBRixDQUFTLENBQUNKLFNBQVMsQ0FBQ1MsRUFBRCxDQUFULENBQWFJLEdBQWQsRUFBbUJiLFNBQVMsQ0FBQ1MsRUFBRCxDQUFULFFBQW5CLENBQVQsRUFBZ0RlLEtBQWhELENBQXNEckIsVUFBdEQsQ0FBVDs7QUFDQSxVQUFHSCxTQUFTLENBQUNTLEVBQUQsQ0FBVCxDQUFhTyxPQUFiLElBQXdCLEVBQTNCLEVBQStCO0FBQzNCWixjQUFNLENBQUNxQixTQUFQLENBQWlCLCtCQUErQnpCLFNBQVMsQ0FBQ1MsRUFBRCxDQUFULENBQWFPLE9BQTVDLEdBQXNELHFCQUF0RCxHQUE4RWhCLFNBQVMsQ0FBQ1MsRUFBRCxDQUFULENBQWFHLElBQTNGLEdBQWtHLE1BQW5IO0FBQ0gsT0FGRCxNQUVPO0FBQ0hSLGNBQU0sQ0FBQ3FCLFNBQVAsQ0FBaUIsdUJBQXVCekIsU0FBUyxDQUFDUyxFQUFELENBQVQsQ0FBYUcsSUFBckQ7QUFDSDtBQUNKO0FBQ0osR0ExQkQ7QUE0QkEsTUFBSWMsU0FBUyxHQUFHckIsUUFBUSxDQUFDc0IsY0FBVCxDQUF3QixRQUF4QixDQUFoQjtBQUNBRCxXQUFTLENBQUNFLEtBQVYsQ0FBZ0JDLE9BQWhCLEdBQTBCLE1BQTFCO0FBQ0EsTUFBSUMsU0FBUyxHQUFHekIsUUFBUSxDQUFDc0IsY0FBVCxDQUF3QixXQUF4QixDQUFoQjtBQUVBRyxXQUFTLENBQUNDLGdCQUFWLENBQTJCLE9BQTNCLEVBQW9DLFlBQVk7QUFDNUNMLGFBQVMsQ0FBQ00sTUFBVixHQUFtQixLQUFuQjtBQUNILEdBRkQ7QUFJQSxNQUFJQyxjQUFjLEdBQUc1QixRQUFRLENBQUNzQixjQUFULENBQXdCLGtCQUF4QixDQUFyQjtBQUVBRyxXQUFTLENBQUNDLGdCQUFWLENBQTJCLE9BQTNCLEVBQW9DLFlBQVk7QUFDNUNMLGFBQVMsQ0FBQ0UsS0FBVixDQUFnQkMsT0FBaEIsR0FBMEIsUUFBMUI7QUFDQUMsYUFBUyxDQUFDRixLQUFWLENBQWdCQyxPQUFoQixHQUEwQixNQUExQjtBQUNBSSxrQkFBYyxDQUFDTCxLQUFmLENBQXFCQyxPQUFyQixHQUErQixNQUEvQjtBQUNILEdBSkQ7QUFNQTs7QUFDQSxNQUFJSyxRQUFRLEdBQUc3QixRQUFRLENBQUNzQixjQUFULENBQXdCLFVBQXhCLENBQWYsQ0E5QzBCLENBOEMwQjs7QUFDcEQsTUFBSVEsUUFBUSxHQUFHOUIsUUFBUSxDQUFDK0IsaUJBQVQsQ0FBMkIsY0FBM0IsQ0FBZixDQS9DMEIsQ0ErQ2lDOztBQUMzRCxNQUFJQyxZQUFZLEdBQUdoQyxRQUFRLENBQUNzQixjQUFULENBQXdCLFVBQXhCLENBQW5CO0FBRUE7O0FBQ0EsTUFBSVcsSUFBSSxHQUFHLElBQVg7O0FBQ0EsT0FBSyxJQUFJN0IsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRzBCLFFBQVEsQ0FBQ3pCLE1BQTdCLEVBQXFDRCxDQUFDLEVBQXRDLEVBQTBDO0FBQ3RDMEIsWUFBUSxDQUFDMUIsQ0FBRCxDQUFSLENBQVlzQixnQkFBWixDQUE2QixRQUE3QixFQUF1QyxZQUFXO0FBQzlDO0FBQ0EsVUFBSSxTQUFTTyxJQUFiLEVBQW1CO0FBQ2ZBLFlBQUksR0FBRyxJQUFQO0FBQ0g7O0FBQ0QsV0FBSyxJQUFJN0IsR0FBQyxHQUFHLENBQVIsRUFBV0MsTUFBTSxHQUFHeUIsUUFBUSxDQUFDekIsTUFBbEMsRUFBMENELEdBQUMsR0FBR0MsTUFBOUMsRUFBc0RELEdBQUMsRUFBdkQsRUFBMkQ7QUFDdkQsWUFBRzBCLFFBQVEsQ0FBQzFCLEdBQUQsQ0FBUixDQUFZOEIsT0FBZixFQUF3QjtBQUNwQjtBQUNBLGNBQUdKLFFBQVEsQ0FBQzFCLEdBQUQsQ0FBUixDQUFZK0IsS0FBWixLQUFzQixhQUF6QixFQUF3QztBQUNwQ25DLG9CQUFRLENBQUNzQixjQUFULENBQXdCLGFBQXhCLEVBQXVDYyxXQUF2QyxHQUFxRCw4QkFBckQ7QUFDSDs7QUFDRCxjQUFHTixRQUFRLENBQUMxQixHQUFELENBQVIsQ0FBWStCLEtBQVosS0FBc0IsU0FBekIsRUFBb0M7QUFDaENuQyxvQkFBUSxDQUFDc0IsY0FBVCxDQUF3QixhQUF4QixFQUF1Q2MsV0FBdkMsR0FBcUQsb0JBQXJEO0FBQ0g7O0FBQ0QsY0FBR04sUUFBUSxDQUFDMUIsR0FBRCxDQUFSLENBQVkrQixLQUFaLEtBQXNCLFFBQXpCLEVBQW1DO0FBQy9CbkMsb0JBQVEsQ0FBQ3NCLGNBQVQsQ0FBd0IsYUFBeEIsRUFBdUNjLFdBQXZDLEdBQXFELHlCQUFyRDtBQUNIO0FBQ0osU0Fac0QsQ0FhM0Q7O0FBQ0g7QUFDQSxLQXBCRDtBQXFCSDtBQUNEOzs7QUFFSVAsVUFBUSxDQUFDSCxnQkFBVCxDQUEwQixPQUExQixFQUFtQyxZQUFZO0FBQzNDNUIsY0FBVSxDQUFDdUMsV0FBWDtBQUNBLFFBQUlDLEVBQUUsR0FBRyxFQUFUO0FBQ0EsUUFBSUMsQ0FBQyxHQUFHLEVBQVI7QUFDQSxRQUFJQyxNQUFNLEdBQUd4QyxRQUFRLENBQUNzQixjQUFULENBQXdCLGFBQXhCLEVBQXVDYSxLQUFwRCxDQUoyQyxDQUlnQjs7QUFKaEIsK0JBS2xDL0IsR0FMa0M7QUFNdkMsVUFBSTBCLFFBQVEsQ0FBQzFCLEdBQUQsQ0FBUixDQUFZOEIsT0FBaEIsRUFBeUI7QUFDckJqRCxTQUFDLENBQUNpQixHQUFGLENBQU0saUNBQU4sRUFBeUMsVUFBVUMsSUFBVixFQUFnQjtBQUNyRCxjQUFJMkIsUUFBUSxDQUFDMUIsR0FBRCxDQUFSLENBQVkrQixLQUFaLEtBQXNCLGFBQTFCLEVBQXlDO0FBQ3JDLGlCQUFLLElBQUkvQixHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHRCxJQUFJLENBQUNFLE1BQXpCLEVBQWlDRCxHQUFDLEVBQWxDLEVBQXNDO0FBQ2xDLGtCQUFJRSxHQUFHLEdBQUdILElBQUksQ0FBQ0MsR0FBRCxDQUFkO0FBQ0FxQyxxQkFBTyxDQUFDQyxHQUFSLENBQVksZUFBZXZDLElBQUksQ0FBQ0MsR0FBRCxDQUEvQjtBQUNBLGtCQUFJRyxJQUFJLEdBQUdELEdBQUcsQ0FBQ3FDLFdBQUosQ0FBZ0JwQyxJQUEzQjs7QUFDQSxrQkFBR2lDLE1BQU0sSUFBSWpDLElBQWIsRUFBbUI7QUFDZmdDLGlCQUFDLENBQUNoQyxJQUFGLEdBQVNELEdBQUcsQ0FBQ1YsUUFBSixDQUFhVyxJQUF0QixDQURlLENBRWY7O0FBQ0FnQyxpQkFBQyxDQUFDL0IsR0FBRixHQUFRRixHQUFHLENBQUNWLFFBQUosQ0FBYWEsUUFBckIsQ0FIZSxDQUlmOztBQUNBOEIsaUJBQUMsUUFBRCxHQUFTakMsR0FBRyxDQUFDVixRQUFKLENBQWFjLFNBQXRCLENBTGUsQ0FNZjs7QUFDQTRCLGtCQUFFLENBQUMxQixJQUFILENBQVEyQixDQUFSOztBQUNBLHFCQUFLLElBQUluQyxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHa0MsRUFBRSxDQUFDakMsTUFBdkIsRUFBK0JELEdBQUMsRUFBaEMsRUFBb0M7QUFDaENMLHdCQUFNLEdBQUdoQixDQUFDLENBQUNnQixNQUFGLENBQVMsQ0FBQ3VDLEVBQUUsQ0FBQ2xDLEdBQUQsQ0FBRixDQUFNSSxHQUFQLEVBQVk4QixFQUFFLENBQUNsQyxHQUFELENBQUYsUUFBWixDQUFULEVBQWtDZSxLQUFsQyxDQUF3Q3JCLFVBQXhDLENBQVQ7QUFDQUMsd0JBQU0sQ0FBQ3FCLFNBQVAsQ0FBaUIsOENBQThDa0IsRUFBRSxDQUFDbEMsR0FBRCxDQUFGLENBQU1HLElBQXBELEdBQTJELE1BQTVFO0FBQ0g7QUFDSjtBQUNKOztBQUNELGdCQUFHK0IsRUFBRSxDQUFDakMsTUFBSCxJQUFhLENBQWhCLEVBQW1CO0FBQ2YyQiwwQkFBWSxDQUFDWSxTQUFiLEdBQXlCLG1CQUF6QjtBQUNIO0FBQ0o7O0FBQ0QsY0FBSWQsUUFBUSxDQUFDMUIsR0FBRCxDQUFSLENBQVkrQixLQUFaLEtBQXNCLFNBQTFCLEVBQXFDO0FBQ2pDLGlCQUFLLElBQUkvQixHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHRCxJQUFJLENBQUNFLE1BQXpCLEVBQWlDRCxHQUFDLEVBQWxDLEVBQXNDO0FBQ2xDLGtCQUFJRSxJQUFHLEdBQUdILElBQUksQ0FBQ0MsR0FBRCxDQUFkO0FBQ0Esa0JBQUl5QyxLQUFLLEdBQUd2QyxJQUFHLENBQUN1QyxLQUFKLENBQVVBLEtBQXRCLENBRmtDLENBR2xDOztBQUNBLGtCQUFHTCxNQUFNLElBQUlLLEtBQWIsRUFBb0I7QUFDaEJOLGlCQUFDLENBQUNoQyxJQUFGLEdBQVNELElBQUcsQ0FBQ1YsUUFBSixDQUFhVyxJQUF0QixDQURnQixDQUVoQjs7QUFDQWdDLGlCQUFDLENBQUMvQixHQUFGLEdBQVFGLElBQUcsQ0FBQ1YsUUFBSixDQUFhYSxRQUFyQixDQUhnQixDQUloQjs7QUFDQThCLGlCQUFDLFFBQUQsR0FBU2pDLElBQUcsQ0FBQ1YsUUFBSixDQUFhYyxTQUF0QixDQUxnQixDQU1oQjs7QUFDQTRCLGtCQUFFLENBQUMxQixJQUFILENBQVEyQixDQUFSOztBQUNBLHFCQUFLLElBQUluQyxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHa0MsRUFBRSxDQUFDakMsTUFBdkIsRUFBK0JELEdBQUMsRUFBaEMsRUFBb0M7QUFDaENMLHdCQUFNLEdBQUdoQixDQUFDLENBQUNnQixNQUFGLENBQVMsQ0FBQ3VDLEVBQUUsQ0FBQ2xDLEdBQUQsQ0FBRixDQUFNSSxHQUFQLEVBQVk4QixFQUFFLENBQUNsQyxHQUFELENBQUYsUUFBWixDQUFULEVBQWtDZSxLQUFsQyxDQUF3Q3JCLFVBQXhDLENBQVQ7QUFDQUMsd0JBQU0sQ0FBQ3FCLFNBQVAsQ0FBaUIsOENBQThDa0IsRUFBRSxDQUFDbEMsR0FBRCxDQUFGLENBQU1HLElBQXBELEdBQTJELE1BQTVFO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7O0FBQ0QsY0FBSXVCLFFBQVEsQ0FBQzFCLEdBQUQsQ0FBUixDQUFZK0IsS0FBWixLQUFzQixRQUExQixFQUFvQztBQUNoQyxpQkFBSyxJQUFJL0IsR0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBR0QsSUFBSSxDQUFDRSxNQUF6QixFQUFpQ0QsR0FBQyxFQUFsQyxFQUFzQztBQUNsQyxrQkFBSUUsS0FBRyxHQUFHSCxJQUFJLENBQUNDLEdBQUQsQ0FBZDtBQUNBLGtCQUFJMEMsT0FBTyxHQUFHeEMsS0FBRyxDQUFDd0MsT0FBSixDQUFZdkMsSUFBMUI7O0FBQ0Esa0JBQUdpQyxNQUFNLElBQUlNLE9BQWIsRUFBc0I7QUFDbEJQLGlCQUFDLENBQUNoQyxJQUFGLEdBQVNELEtBQUcsQ0FBQ1YsUUFBSixDQUFhVyxJQUF0QixDQURrQixDQUVsQjs7QUFDQWdDLGlCQUFDLENBQUMvQixHQUFGLEdBQVFGLEtBQUcsQ0FBQ1YsUUFBSixDQUFhYSxRQUFyQixDQUhrQixDQUlsQjs7QUFDQThCLGlCQUFDLFFBQUQsR0FBU2pDLEtBQUcsQ0FBQ1YsUUFBSixDQUFhYyxTQUF0QixDQUxrQixDQU1sQjs7QUFDQTRCLGtCQUFFLENBQUMxQixJQUFILENBQVEyQixDQUFSOztBQUNBLHFCQUFLLElBQUluQyxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHa0MsRUFBRSxDQUFDakMsTUFBdkIsRUFBK0JELEdBQUMsRUFBaEMsRUFBb0M7QUFDaENMLHdCQUFNLEdBQUdoQixDQUFDLENBQUNnQixNQUFGLENBQVMsQ0FBQ3VDLEVBQUUsQ0FBQ2xDLEdBQUQsQ0FBRixDQUFNSSxHQUFQLEVBQVk4QixFQUFFLENBQUNsQyxHQUFELENBQUYsUUFBWixDQUFULEVBQWtDZSxLQUFsQyxDQUF3Q3JCLFVBQXhDLENBQVQ7QUFDQUMsd0JBQU0sQ0FBQ3FCLFNBQVAsQ0FBaUIsOENBQThDa0IsRUFBRSxDQUFDbEMsR0FBRCxDQUFGLENBQU1HLElBQXBELEdBQTJELE1BQTVFO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSixTQS9ERDtBQWdFSDtBQXZFc0M7O0FBSzNDLFNBQUssSUFBSUgsR0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBRzBCLFFBQVEsQ0FBQ3pCLE1BQTdCLEVBQXFDRCxHQUFDLEVBQXRDLEVBQTBDO0FBQUEsWUFBakNBLEdBQWlDO0FBbUV6QztBQUNKLEdBekVEO0FBMEVILENBdkpMLEUsQ0F5SkE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEkiLCJmaWxlIjoibGVhZmxldC5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBMPXJlcXVpcmUoJ2xlYWZsZXQnKTtcclxubGV0ICQgPSByZXF1aXJlKCdqcXVlcnknKTtcclxubGV0IGMgPSByZXF1aXJlKCcuLi9jc3MvYXBwLnNjc3MnKTtcclxuXHJcbi8vdGhpcyBmaXhlcyBhIGxlYWZsZXQgYnVnIHRoYXQgZG9lcyBub3QgaW1wb3J0IHRoZSBtYXJrZXIgaW1hZ2VzIGlmIHdlIGRvbid0IGFkZCB0aG9zZSBsaW5lc1xyXG5kZWxldGUgTC5JY29uLkRlZmF1bHQucHJvdG90eXBlLl9nZXRJY29uVXJsO1xyXG5MLkljb24uRGVmYXVsdC5tZXJnZU9wdGlvbnMoe1xyXG4gICAgaWNvblJldGluYVVybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi0yeC5wbmcnKSxcclxuICAgIGljb25Vcmw6IHJlcXVpcmUoJ2xlYWZsZXQvZGlzdC9pbWFnZXMvbWFya2VyLWljb24ucG5nJyksXHJcbiAgICBzaGFkb3dVcmw6IHJlcXVpcmUoJ2xlYWZsZXQvZGlzdC9pbWFnZXMvbWFya2VyLXNoYWRvdy5wbmcnKSxcclxufSk7XHJcblxyXG5sZXQgcHJvZHVjZXJzID0gW107XHJcbmxldCBwcm9kdWNlciA9IHt9O1xyXG5sZXQgbXltYXA7XHJcbmxldCBsYXllckdyb3VwO1xyXG5sZXQgbWFya2VyO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgJC5nZXQoXCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3Byb2R1Y2Vyc1wiLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgbGV0IHByb2R1Y2VyID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogb2JqLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsYXQ6IG9iai5sYXRpdHVkZSxcclxuICAgICAgICAgICAgICAgIGxvbmc6IG9iai5sb25naXR1ZGUsXHJcbiAgICAgICAgICAgICAgICB3ZWJzaXRlOiBvYmoud2Vic2l0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBwcm9kdWNlcnMucHVzaChwcm9kdWNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG15bWFwID0gTC5tYXAoJ21hcGlkJywge21pblpvb206IDUsIG1heFpvb206IDh9KS5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgNik7XHJcbiAgICAgICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vbWFwcy5oZWlnaXQub3JnL29wZW5tYXBzdXJmZXIvdGlsZXMvcm9hZHMvd2VibWVyY2F0b3Ive3p9L3t4fS97eX0ucG5nJywge1xyXG4gICAgICAgICAgICBtYXhab29tOiAxOSxcclxuICAgICAgICAgICAgYXR0cmlidXRpb246ICdJbWFnZXJ5IGZyb20gPGEgaHJlZj1cImh0dHA6Ly9naXNjaWVuY2UudW5pLWhkLmRlL1wiPkdJU2NpZW5jZSBSZXNlYXJjaCBHcm91cCBAIFVuaXZlcnNpdHkgb2YgSGVpZGVsYmVyZzwvYT4gfCBNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodFwiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycydcclxuICAgICAgICB9KS5hZGRUbyhteW1hcCk7XHJcblxyXG4gICAgICAgIGxheWVyR3JvdXAgPSBMLmxheWVyR3JvdXAoKS5hZGRUbyhteW1hcCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9kdWNlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3Byb2R1Y2Vyc1tpXS5sYXQsIHByb2R1Y2Vyc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgIGlmKHByb2R1Y2Vyc1tpXS53ZWJzaXRlICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSB0YXJnZXQ9XFxcIl9ibGFua1xcXCIgaHJlZj1cIiArIHByb2R1Y2Vyc1tpXS53ZWJzaXRlICsgXCI+PGI+RG9tYWluZTwvYj48YnI+XCIgKyBwcm9kdWNlcnNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8Yj5Eb21haW5lPC9iPjxicj5cIiArIHByb2R1Y2Vyc1tpXS5uYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBzZWFyY2hEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFwiKTtcclxuICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICBsZXQgc2VhcmNoT3B0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hPcHRcIik7XHJcblxyXG4gICAgc2VhcmNoT3B0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VhcmNoRGl2LmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGRyb3BEd25Db250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkcm9wZG93bi1jb250ZW50XCIpO1xyXG5cclxuICAgIHNlYXJjaE9wdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcclxuICAgICAgICBzZWFyY2hPcHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIGRyb3BEd25Db250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVNUVUZGUyBUTyBGSUxURVIgU0VBUkNIIE9OIE1BUC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgbGV0IHNlYXJjaEJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hCdFwiKTsgLy9sZSBib3V0dG9uIHJlY2hlcmNoZXJcclxuICAgIGxldCByYWRpb09wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCdzZWFyY2hPcHRpb24nKTsgLy9sZSByYWRpbyBidCBjaG9zZW4gYnkgdXNlciB0byBmaWx0ZXIgYnlcclxuICAgIGxldCByZXNOb3RERm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90Rm91bmQnKTtcclxuXHJcbiAgICAvKi4uLi5jb250cm9scyB0aGUgcGxhY2Vob2xkZXIgb2YgdGhlIHNlYXJjaCBiYXIgd2hlbiBwaWNraW5nIGRpZmZlcmVudCBmaWx0ZXJpbmcgb3B0aW9ucyBmcm9tIHRoZSByYWRpbyBidXR0b25zIC4uLi4qL1xyXG4gICAgbGV0IHByZXYgPSBudWxsO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpb09wdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJhZGlvT3B0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyhwcmV2KSA/IGNvbnNvbGUubG9nKHByZXYudmFsdWUpOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcyAhPT0gcHJldikge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHJhZGlvT3B0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJhZGlvIGNoZWNrZWQgPSBcIiArIHJhZGlvT3B0W2ldLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikucGxhY2Vob2xkZXIgPSAnRW50cmV6IHVuIG5vbSBkXFwnYXBwZWxsYXRpb24nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjb3VsZXVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS5wbGFjZWhvbGRlciA9ICdFbnRyZXogdW5lIGNvdWxldXInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjZXBhZ2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnBsYWNlaG9sZGVyID0gJ0VudHJleiB1biBub20gZGUgY8OpcGFnZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudmFsdWUpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyouLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uKi9cclxuXHJcbiAgICAgICAgc2VhcmNoQnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGF5ZXJHcm91cC5jbGVhckxheWVycygpO1xyXG4gICAgICAgICAgICBsZXQgcHMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHAgPSB7fTtcclxuICAgICAgICAgICAgbGV0IHNlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikudmFsdWU7IC8vY2UgcXUnYSBlY3JpdCBsJ3V0aWxpc2F0ZXVyIGRhbnMgbGEgYmFycmUgZGUgcmVjaGVyY2hlXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFkaW9PcHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5nZXQoXCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3dpbmVzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRBVEFbaV0gPSBcIiArIGRhdGFbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gb2JqLmRlc2lnbmF0aW9uLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzTm90REZvdW5kLmlubmVyVGV4dCA9IFwiUGFzIGRlIHLDqXN1bHRhdHMuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY291bGV1clwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBvYmouY29sb3IuY29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkNPTE9SID0gXCIgKyBjb2xvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IGNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubmFtZSA9IG9iai5wcm9kdWNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sYXQgPSBvYmoucHJvZHVjZXIubGF0aXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubG9uZyA9IG9iai5wcm9kdWNlci5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxvbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcy5wdXNoKHApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBMLm1hcmtlcihbcHNbaV0ubGF0LCBwc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGEgaHJlZj0nL2luZm9fd2luZXJ5Jz48Yj5Eb21haW5lPC9iPjxicj5cIiArIHBzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNlcGFnZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWV0eSA9IG9iai52YXJpZXR5Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IHZhcmlldHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbi8vIFRoZSBMZWFmbGV0IEwuTWFwIGNsYXNzIHByb3ZpZGVzIHRoZSBmaXRCb3VuZHMgbWV0aG9kIHRvIHpvb20gYSBtYXAgdG8gY29udGFpbiBhIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIEwubGF0TG5nQm91bmRzIHV0aWxpdHkgZnVuY3Rpb24gY3JlYXRlcyBhIGJvdW5kaW5nIGJveCBvYmplY3QgZnJvbSBhbiBhcnJheSBvZiBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGVzLlxyXG4vLyBXaXRoIGEgc2luZ2xlIG1hcmtlciwgaG93ZXZlciwgd2Ugb25seSBoYXZlIG9uZSBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGUgZnJvbSB3aGljaCB0byBjcmVhdGUgdGhlIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIHNvbHV0aW9uIGlzIHRvIGNyZWF0ZSBhIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmcgdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLlxyXG5cclxuLy8gVGhlIGZvbGxvd2luZyBmdW5jdGlvbiBjZW50ZXJzIGFuZCB6b29tcyBhIGxlYWZsZXQgbWFwIG9uIGEgc2luZ2xlIG1hcmtlci4gTGluZSAyIGNyZWF0ZXMgdGhlIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmdcclxuLy8gdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLiBMaW5lIDMgY3JlYXRlcyB0aGUgYm91bmRpbmcgYm94IHRoYXQgZW5jbG9zZXMgdGhlIG1hcmtlcuKAmXMgbG9jYXRpb24uIEZpbmFsbHksXHJcbi8vIGxpbmUgNCB6b29tcyB0aGUgbWFwIHRvIGVuY2xvc2UgdGhlIGJvdW5kaW5nIGJveC5cclxuXHJcbi8vIGZ1bmN0aW9uIGNlbnRlckxlYWZsZXRNYXBPbk1hcmtlcihtYXAsIG1hcmtlcikge1xyXG4vLyAgICAgdmFyIGxhdExuZ3MgPSBbIG1hcmtlci5nZXRMYXRMbmcoKSBdO1xyXG4vLyAgICAgdmFyIG1hcmtlckJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGxhdExuZ3MpO1xyXG4vLyAgICAgbWFwLmZpdEJvdW5kcyhtYXJrZXJCb3VuZHMpO1xyXG4vLyB9XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=
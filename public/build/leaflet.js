(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["leaflet"],{

/***/ "./assets/js/leaflet.js":
/*!******************************!*\
  !*** ./assets/js/leaflet.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.map */ "./node_modules/core-js/modules/es.array.map.js");

__webpack_require__(/*! core-js/modules/es.function.name */ "./node_modules/core-js/modules/es.function.name.js");

var L = __webpack_require__(/*! leaflet */ "./node_modules/leaflet/dist/leaflet-src.js");

var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js"); //this fixes a leaflet bug that does not import the marker images if we don't add those lines


delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon-2x.png */ "./node_modules/leaflet/dist/images/marker-icon-2x.png"),
  iconUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon.png */ "./node_modules/leaflet/dist/images/marker-icon.png"),
  shadowUrl: __webpack_require__(/*! leaflet/dist/images/marker-shadow.png */ "./node_modules/leaflet/dist/images/marker-shadow.png")
});
var producers = [];
var producer = {};
var mymap;
var layerGroup;
var marker;
$(document).ready(function () {
  $.get("http://127.0.0.1:8000/api/producers", function (data) {
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      var _producer = {
        name: obj.name,
        lat: obj.latitude,
        "long": obj.longitude,
        website: obj.website
      };
      producers.push(_producer);
    }

    mymap = L.map('mapid', {
      minZoom: 5,
      maxZoom: 8
    }).setView([46.227638, 2.213749], 6);
    L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);
    layerGroup = L.layerGroup().addTo(mymap);

    for (var _i = 0; _i < producers.length; _i++) {
      marker = L.marker([producers[_i].lat, producers[_i]["long"]]).addTo(layerGroup);

      if (producers[_i].website != "") {
        marker.bindPopup("<a target=\"_blank\" href=" + producers[_i].website + "><b>Domaine</b><br>" + producers[_i].name + "</a>");
      } else {
        marker.bindPopup("<b>Domaine</b><br>" + producers[_i].name);
      }
    }
  });
  var searchDiv = document.getElementById("search");
  searchDiv.style.display = "none";
  var searchOpt = document.getElementById("searchOpt");
  searchOpt.addEventListener("click", function () {
    searchDiv.hidden = false;
  });
  var dropDwnContent = document.getElementById("dropdown-content");
  searchOpt.addEventListener("click", function () {
    searchDiv.style.display = "inline";
    searchOpt.style.display = "none";
    dropDwnContent.style.display = "none";
  });
  /*----------------------------STUFFS TO FILTER SEARCH ON MAP-------------------------------*/

  var searchBt = document.getElementById("searchBt"); //le boutton rechercher

  var radioOpt = document.getElementsByName('searchOption'); //le radio bt chosen by user to filter by

  var resNotDFound = document.getElementById('notFound');
  /*....controls the placeholder of the search bar when picking different filtering options from the radio buttons ....*/

  var prev = null;

  for (var i = 0; i < radioOpt.length; i++) {
    radioOpt[i].addEventListener('change', function () {
      //(prev) ? console.log(prev.value): null;
      if (this !== prev) {
        prev = this;
      }

      for (var _i2 = 0, length = radioOpt.length; _i2 < length; _i2++) {
        if (radioOpt[_i2].checked) {
          //console.log("radio checked = " + radioOpt[i].value);
          if (radioOpt[_i2].value === "appellation") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom d\'appellation';
          }

          if (radioOpt[_i2].value === "couleur") {
            document.getElementById("searchQuery").placeholder = 'Entrez une couleur';
          }

          if (radioOpt[_i2].value === "cepage") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom de cépage';
          }
        } //console.log(this.value)

      }
    });
  }
  /*.............................................................................................................*/


  searchBt.addEventListener("click", function () {
    layerGroup.clearLayers();
    var ps = [];
    var p = {};
    var search = document.getElementById("searchQuery").value; //ce qu'a ecrit l'utilisateur dans la barre de recherche

    var _loop = function _loop(_i3) {
      if (radioOpt[_i3].checked) {
        $.get("http://127.0.0.1:8000/api/wines", function (data) {
          if (radioOpt[_i3].value === "appellation") {
            for (var _i4 = 0; _i4 < data.length; _i4++) {
              var obj = data[_i4];
              console.log("DATA[i] = " + data[_i4]);
              var name = obj.designation.name;

              if (search == name) {
                p.name = obj.producer.name; //console.log("name found = " + p.name);

                p.lat = obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i5 = 0; _i5 < ps.length; _i5++) {
                  marker = L.marker([ps[_i5].lat, ps[_i5]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i5].name + "</a>");
                }
              }
            }

            if (ps.length == 0) {
              resNotDFound.innerText = "Pas de résultats.";
            }
          }

          if (radioOpt[_i3].value === "couleur") {
            for (var _i6 = 0; _i6 < data.length; _i6++) {
              var _obj = data[_i6];
              var color = _obj.color.color; //console.log("COLOR = " + color);

              if (search == color) {
                p.name = _obj.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i7 = 0; _i7 < ps.length; _i7++) {
                  marker = L.marker([ps[_i7].lat, ps[_i7]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i7].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "cepage") {
            for (var _i8 = 0; _i8 < data.length; _i8++) {
              var _obj2 = data[_i8];
              var variety = _obj2.variety.name;

              if (search == variety) {
                p.name = _obj2.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj2.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj2.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i9 = 0; _i9 < ps.length; _i9++) {
                  marker = L.marker([ps[_i9].lat, ps[_i9]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i9].name + "</a>");
                }
              }
            }
          }
        });
      }
    };

    for (var _i3 = 0; _i3 < radioOpt.length; _i3++) {
      _loop(_i3);
    }
  });
}); // The Leaflet L.Map class provides the fitBounds method to zoom a map to contain a rectangular bounding box.
// The L.latLngBounds utility function creates a bounding box object from an array of latitude and longitude coordinates.
// With a single marker, however, we only have one latitude and longitude coordinate from which to create the bounding box.
// The solution is to create a single-element array containing the latitude and longitude coordinate of the marker.
// The following function centers and zooms a leaflet map on a single marker. Line 2 creates the single-element array containing
// the latitude and longitude coordinate of the marker. Line 3 creates the bounding box that encloses the marker’s location. Finally,
// line 4 zooms the map to enclose the bounding box.
// function centerLeafletMapOnMarker(map, marker) {
//     var latLngs = [ marker.getLatLng() ];
//     var markerBounds = L.latLngBounds(latLngs);
//     map.fitBounds(markerBounds);
// }

/***/ })

},[["./assets/js/leaflet.js","runtime","vendors~app~leaflet","vendors~leaflet"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvbGVhZmxldC5qcyJdLCJuYW1lcyI6WyJMIiwicmVxdWlyZSIsIiQiLCJJY29uIiwiRGVmYXVsdCIsInByb3RvdHlwZSIsIl9nZXRJY29uVXJsIiwibWVyZ2VPcHRpb25zIiwiaWNvblJldGluYVVybCIsImljb25VcmwiLCJzaGFkb3dVcmwiLCJwcm9kdWNlcnMiLCJwcm9kdWNlciIsIm15bWFwIiwibGF5ZXJHcm91cCIsIm1hcmtlciIsImRvY3VtZW50IiwicmVhZHkiLCJnZXQiLCJkYXRhIiwiaSIsImxlbmd0aCIsIm9iaiIsIm5hbWUiLCJsYXQiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIndlYnNpdGUiLCJwdXNoIiwibWFwIiwibWluWm9vbSIsIm1heFpvb20iLCJzZXRWaWV3IiwidGlsZUxheWVyIiwiYXR0cmlidXRpb24iLCJhZGRUbyIsImJpbmRQb3B1cCIsInNlYXJjaERpdiIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJkaXNwbGF5Iiwic2VhcmNoT3B0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImhpZGRlbiIsImRyb3BEd25Db250ZW50Iiwic2VhcmNoQnQiLCJyYWRpb09wdCIsImdldEVsZW1lbnRzQnlOYW1lIiwicmVzTm90REZvdW5kIiwicHJldiIsImNoZWNrZWQiLCJ2YWx1ZSIsInBsYWNlaG9sZGVyIiwiY2xlYXJMYXllcnMiLCJwcyIsInAiLCJzZWFyY2giLCJjb25zb2xlIiwibG9nIiwiZGVzaWduYXRpb24iLCJpbm5lclRleHQiLCJjb2xvciIsInZhcmlldHkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFDLEdBQUNDLG1CQUFPLENBQUMsMkRBQUQsQ0FBYjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdELG1CQUFPLENBQUMsb0RBQUQsQ0FBZixDLENBRUE7OztBQUNBLE9BQU9ELENBQUMsQ0FBQ0csSUFBRixDQUFPQyxPQUFQLENBQWVDLFNBQWYsQ0FBeUJDLFdBQWhD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QUNsQyxHQUFELENBQUYsQ0FBTUcsSUFBcEQsR0FBMkQsTUFBNUU7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKLFNBL0REO0FBZ0VIO0FBdkVzQzs7QUFLM0MsU0FBSyxJQUFJSCxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHMEIsUUFBUSxDQUFDekIsTUFBN0IsRUFBcUNELEdBQUMsRUFBdEMsRUFBMEM7QUFBQSxZQUFqQ0EsR0FBaUM7QUFtRXpDO0FBQ0osR0F6RUQ7QUEwRUgsQ0F4SkwsRSxDQTBKQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSSIsImZpbGUiOiJsZWFmbGV0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IEw9cmVxdWlyZSgnbGVhZmxldCcpO1xyXG5sZXQgJCA9IHJlcXVpcmUoJ2pxdWVyeScpO1xyXG5cclxuLy90aGlzIGZpeGVzIGEgbGVhZmxldCBidWcgdGhhdCBkb2VzIG5vdCBpbXBvcnQgdGhlIG1hcmtlciBpbWFnZXMgaWYgd2UgZG9uJ3QgYWRkIHRob3NlIGxpbmVzXHJcbmRlbGV0ZSBMLkljb24uRGVmYXVsdC5wcm90b3R5cGUuX2dldEljb25Vcmw7XHJcbkwuSWNvbi5EZWZhdWx0Lm1lcmdlT3B0aW9ucyh7XHJcbiAgICBpY29uUmV0aW5hVXJsOiByZXF1aXJlKCdsZWFmbGV0L2Rpc3QvaW1hZ2VzL21hcmtlci1pY29uLTJ4LnBuZycpLFxyXG4gICAgaWNvblVybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi5wbmcnKSxcclxuICAgIHNoYWRvd1VybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItc2hhZG93LnBuZycpLFxyXG59KTtcclxuXHJcbmxldCBwcm9kdWNlcnMgPSBbXTtcclxubGV0IHByb2R1Y2VyID0ge307XHJcbmxldCBteW1hcDtcclxubGV0IGxheWVyR3JvdXA7XHJcbmxldCBtYXJrZXI7XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAkLmdldChcImh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvcHJvZHVjZXJzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICBsZXQgcHJvZHVjZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBvYmoubmFtZSxcclxuICAgICAgICAgICAgICAgIGxhdDogb2JqLmxhdGl0dWRlLFxyXG4gICAgICAgICAgICAgICAgbG9uZzogb2JqLmxvbmdpdHVkZSxcclxuICAgICAgICAgICAgICAgIHdlYnNpdGU6IG9iai53ZWJzaXRlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHByb2R1Y2Vycy5wdXNoKHByb2R1Y2VyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG15bWFwID0gTC5tYXAoJ21hcGlkJywge21pblpvb206IDUsIG1heFpvb206IDh9KS5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgNik7XHJcbiAgICAgICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vbWFwcy5oZWlnaXQub3JnL29wZW5tYXBzdXJmZXIvdGlsZXMvcm9hZHMvd2VibWVyY2F0b3Ive3p9L3t4fS97eX0ucG5nJywge1xyXG4gICAgICAgICAgICBtYXhab29tOiAxOSxcclxuICAgICAgICAgICAgYXR0cmlidXRpb246ICdJbWFnZXJ5IGZyb20gPGEgaHJlZj1cImh0dHA6Ly9naXNjaWVuY2UudW5pLWhkLmRlL1wiPkdJU2NpZW5jZSBSZXNlYXJjaCBHcm91cCBAIFVuaXZlcnNpdHkgb2YgSGVpZGVsYmVyZzwvYT4gfCBNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodFwiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycydcclxuICAgICAgICB9KS5hZGRUbyhteW1hcCk7XHJcblxyXG4gICAgICAgIGxheWVyR3JvdXAgPSBMLmxheWVyR3JvdXAoKS5hZGRUbyhteW1hcCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9kdWNlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3Byb2R1Y2Vyc1tpXS5sYXQsIHByb2R1Y2Vyc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgIGlmKHByb2R1Y2Vyc1tpXS53ZWJzaXRlICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSB0YXJnZXQ9XFxcIl9ibGFua1xcXCIgaHJlZj1cIiArIHByb2R1Y2Vyc1tpXS53ZWJzaXRlICsgXCI+PGI+RG9tYWluZTwvYj48YnI+XCIgKyBwcm9kdWNlcnNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8Yj5Eb21haW5lPC9iPjxicj5cIiArIHByb2R1Y2Vyc1tpXS5uYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBzZWFyY2hEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFwiKTtcclxuICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICBsZXQgc2VhcmNoT3B0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hPcHRcIik7XHJcblxyXG4gICAgc2VhcmNoT3B0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VhcmNoRGl2LmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGRyb3BEd25Db250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkcm9wZG93bi1jb250ZW50XCIpO1xyXG5cclxuICAgIHNlYXJjaE9wdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcclxuICAgICAgICBzZWFyY2hPcHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIGRyb3BEd25Db250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVNUVUZGUyBUTyBGSUxURVIgU0VBUkNIIE9OIE1BUC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgbGV0IHNlYXJjaEJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hCdFwiKTsgLy9sZSBib3V0dG9uIHJlY2hlcmNoZXJcclxuICAgIGxldCByYWRpb09wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCdzZWFyY2hPcHRpb24nKTsgLy9sZSByYWRpbyBidCBjaG9zZW4gYnkgdXNlciB0byBmaWx0ZXIgYnlcclxuICAgIGxldCByZXNOb3RERm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90Rm91bmQnKTtcclxuXHJcbiAgICAvKi4uLi5jb250cm9scyB0aGUgcGxhY2Vob2xkZXIgb2YgdGhlIHNlYXJjaCBiYXIgd2hlbiBwaWNraW5nIGRpZmZlcmVudCBmaWx0ZXJpbmcgb3B0aW9ucyBmcm9tIHRoZSByYWRpbyBidXR0b25zIC4uLi4qL1xyXG4gICAgbGV0IHByZXYgPSBudWxsO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpb09wdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJhZGlvT3B0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyhwcmV2KSA/IGNvbnNvbGUubG9nKHByZXYudmFsdWUpOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcyAhPT0gcHJldikge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHJhZGlvT3B0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJhZGlvIGNoZWNrZWQgPSBcIiArIHJhZGlvT3B0W2ldLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikucGxhY2Vob2xkZXIgPSAnRW50cmV6IHVuIG5vbSBkXFwnYXBwZWxsYXRpb24nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjb3VsZXVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS5wbGFjZWhvbGRlciA9ICdFbnRyZXogdW5lIGNvdWxldXInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjZXBhZ2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnBsYWNlaG9sZGVyID0gJ0VudHJleiB1biBub20gZGUgY8OpcGFnZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudmFsdWUpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyouLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uKi9cclxuXHJcbiAgICAgICAgc2VhcmNoQnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGF5ZXJHcm91cC5jbGVhckxheWVycygpO1xyXG4gICAgICAgICAgICBsZXQgcHMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHAgPSB7fTtcclxuICAgICAgICAgICAgbGV0IHNlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikudmFsdWU7IC8vY2UgcXUnYSBlY3JpdCBsJ3V0aWxpc2F0ZXVyIGRhbnMgbGEgYmFycmUgZGUgcmVjaGVyY2hlXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFkaW9PcHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5nZXQoXCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3dpbmVzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRBVEFbaV0gPSBcIiArIGRhdGFbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gb2JqLmRlc2lnbmF0aW9uLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzTm90REZvdW5kLmlubmVyVGV4dCA9IFwiUGFzIGRlIHLDqXN1bHRhdHMuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY291bGV1clwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBvYmouY29sb3IuY29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkNPTE9SID0gXCIgKyBjb2xvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IGNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubmFtZSA9IG9iai5wcm9kdWNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sYXQgPSBvYmoucHJvZHVjZXIubGF0aXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubG9uZyA9IG9iai5wcm9kdWNlci5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxvbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcy5wdXNoKHApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBMLm1hcmtlcihbcHNbaV0ubGF0LCBwc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGEgaHJlZj0nL2luZm9fd2luZXJ5Jz48Yj5Eb21haW5lPC9iPjxicj5cIiArIHBzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNlcGFnZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWV0eSA9IG9iai52YXJpZXR5Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoID09IHZhcmlldHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbi8vIFRoZSBMZWFmbGV0IEwuTWFwIGNsYXNzIHByb3ZpZGVzIHRoZSBmaXRCb3VuZHMgbWV0aG9kIHRvIHpvb20gYSBtYXAgdG8gY29udGFpbiBhIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIEwubGF0TG5nQm91bmRzIHV0aWxpdHkgZnVuY3Rpb24gY3JlYXRlcyBhIGJvdW5kaW5nIGJveCBvYmplY3QgZnJvbSBhbiBhcnJheSBvZiBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGVzLlxyXG4vLyBXaXRoIGEgc2luZ2xlIG1hcmtlciwgaG93ZXZlciwgd2Ugb25seSBoYXZlIG9uZSBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGUgZnJvbSB3aGljaCB0byBjcmVhdGUgdGhlIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIHNvbHV0aW9uIGlzIHRvIGNyZWF0ZSBhIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmcgdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLlxyXG5cclxuLy8gVGhlIGZvbGxvd2luZyBmdW5jdGlvbiBjZW50ZXJzIGFuZCB6b29tcyBhIGxlYWZsZXQgbWFwIG9uIGEgc2luZ2xlIG1hcmtlci4gTGluZSAyIGNyZWF0ZXMgdGhlIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmdcclxuLy8gdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLiBMaW5lIDMgY3JlYXRlcyB0aGUgYm91bmRpbmcgYm94IHRoYXQgZW5jbG9zZXMgdGhlIG1hcmtlcuKAmXMgbG9jYXRpb24uIEZpbmFsbHksXHJcbi8vIGxpbmUgNCB6b29tcyB0aGUgbWFwIHRvIGVuY2xvc2UgdGhlIGJvdW5kaW5nIGJveC5cclxuXHJcbi8vIGZ1bmN0aW9uIGNlbnRlckxlYWZsZXRNYXBPbk1hcmtlcihtYXAsIG1hcmtlcikge1xyXG4vLyAgICAgdmFyIGxhdExuZ3MgPSBbIG1hcmtlci5nZXRMYXRMbmcoKSBdO1xyXG4vLyAgICAgdmFyIG1hcmtlckJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGxhdExuZ3MpO1xyXG4vLyAgICAgbWFwLmZpdEJvdW5kcyhtYXJrZXJCb3VuZHMpO1xyXG4vLyB9XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=
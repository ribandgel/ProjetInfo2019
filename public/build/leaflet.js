(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["leaflet"],{

/***/ "./assets/js/leaflet.js":
/*!******************************!*\
  !*** ./assets/js/leaflet.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.map */ "./node_modules/core-js/modules/es.array.map.js");

__webpack_require__(/*! core-js/modules/es.function.name */ "./node_modules/core-js/modules/es.function.name.js");

var L = __webpack_require__(/*! leaflet */ "./node_modules/leaflet/dist/leaflet-src.js");

var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js"); //this fixes a leaflet bug that does not import the marker images if we don't add those lines


delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon-2x.png */ "./node_modules/leaflet/dist/images/marker-icon-2x.png"),
  iconUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon.png */ "./node_modules/leaflet/dist/images/marker-icon.png"),
  shadowUrl: __webpack_require__(/*! leaflet/dist/images/marker-shadow.png */ "./node_modules/leaflet/dist/images/marker-shadow.png")
});
var producers = [];
var producer = {};
var mymap;
var layerGroup;
var marker;
$(document).ready(function () {
  $.get("http://127.0.0.1:8000/api/producers", function (data) {
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      var name = obj.name;
      var lat = obj.latitude;
      var _long = obj.longitude;
      var _producer = {
        name: obj.name,
        lat: obj.latitude,
        "long": obj.longitude
      };
      producers.push(_producer);
    }

    mymap = L.map('mapid').setView([46.227638, 2.213749], 6);
    L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);
    layerGroup = L.layerGroup().addTo(mymap);

    for (var _i = 0; _i < producers.length; _i++) {
      marker = L.marker([producers[_i].lat, producers[_i]["long"]]).addTo(layerGroup);
      marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + producers[_i].name + "</a>");
    }
  });
  var searchDiv = document.getElementById("search");
  searchDiv.style.display = "none";
  var searchOpt = document.getElementById("searchOpt");
  searchOpt.addEventListener("click", function () {
    searchDiv.hidden = false;
  });
  var dropDwnContent = document.getElementById("dropdown-content");
  searchOpt.addEventListener("click", function () {
    searchDiv.style.display = "inline";
    searchOpt.style.display = "none";
    dropDwnContent.style.display = "none";
  });
  /*----------------------------STUFFS TO FILTER SEARCH ON MAP-------------------------------*/

  var searchBt = document.getElementById("searchBt"); //le boutton rechercher

  var radioOpt = document.getElementsByName('searchOption'); //le radio bt chosen by user to filter by

  /*---- controls the placeholder of the search bar when picking different filtering options from the radio buttons ----*/

  var prev = null;

  for (var i = 0; i < radioOpt.length; i++) {
    radioOpt[i].addEventListener('change', function () {
      //(prev) ? console.log(prev.value): null;
      if (this !== prev) {
        prev = this;
      }

      for (var _i2 = 0, length = radioOpt.length; _i2 < length; _i2++) {
        if (radioOpt[_i2].checked) {
          console.log("radio checked = " + radioOpt[_i2].value);

          if (radioOpt[_i2].value === "appellation") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom d\'appellation';
          }

          if (radioOpt[_i2].value === "couleur") {
            document.getElementById("searchQuery").placeholder = 'Entrez une couleur';
          }

          if (radioOpt[_i2].value === "cepage") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom de cÃ©page';
          }
        } //console.log(this.value)

      }
    });
  }
  /*-----------------------------------------------------------------------------------------*/


  searchBt.addEventListener("click", function () {
    layerGroup.clearLayers();
    var ps = [];
    var p = {};
    var search = document.getElementById("searchQuery").value; //ce qu'a ecrit l'utilisateur dans la barre de recherche

    var _loop = function _loop(_i3) {
      if (radioOpt[_i3].checked) {
        $.get("http://127.0.0.1:8000/api/wines", function (data) {
          if (radioOpt[_i3].value === "appellation") {
            for (var _i4 = 0; _i4 < data.length; _i4++) {
              var obj = data[_i4];
              var name = obj.designation.name;
              console.log("NAME = " + name);

              if (search == name) {
                p.name = obj.producer.name; //console.log("name found = " + p.name);

                p.lat = obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i5 = 0; _i5 < ps.length; _i5++) {
                  marker = L.marker([ps[_i5].lat, ps[_i5]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i5].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "couleur") {
            for (var _i6 = 0; _i6 < data.length; _i6++) {
              var _obj = data[_i6];
              var color = _obj.color.color;
              console.log("COLOR = " + color);

              if (search == color) {
                p.name = _obj.producer.name;
                console.log("name found = " + p.name);
                p.lat = _obj.producer.latitude;
                console.log("name found = " + p.lat);
                p["long"] = _obj.producer.longitude;
                console.log("name found = " + p["long"]);
                ps.push(p);

                for (var _i7 = 0; _i7 < ps.length; _i7++) {
                  marker = L.marker([ps[_i7].lat, ps[_i7]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i7].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "cepage") {
            for (var _i8 = 0; _i8 < data.length; _i8++) {
              var _obj2 = data[_i8];
              var variety = _obj2.variety.name;

              if (search == variety) {
                p.name = _obj2.producer.name;
                console.log("name found = " + p.name);
                p.lat = _obj2.producer.latitude;
                console.log("name found = " + p.lat);
                p["long"] = _obj2.producer.longitude;
                console.log("name found = " + p["long"]);
                ps.push(p);

                for (var _i9 = 0; _i9 < ps.length; _i9++) {
                  marker = L.marker([ps[_i9].lat, ps[_i9]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i9].name + "</a>");
                }
              }
            }
          }
        });
      }
    };

    for (var _i3 = 0; _i3 < radioOpt.length; _i3++) {
      _loop(_i3);
    }
  });
});

/***/ })

},[["./assets/js/leaflet.js","runtime","vendors~app~leaflet","vendors~leaflet"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvbGVhZmxldC5qcyJdLCJuYW1lcyI6WyJMIiwicmVxdWlyZSIsIiQiLCJJY29uIiwiRGVmYXVsdCIsInByb3RvdHlwZSIsIl9nZXRJY29uVXJsIiwibWVyZ2VPcHRpb25zIiwiaWNvblJldGluYVVybCIsImljb25VcmwiLCJzaGFkb3dVcmwiLCJwcm9kdWNlcnMiLCJwcm9kdWNlciIsIm15bWFwIiwibGF5ZXJHcm91cCIsIm1hcmtlciIsImRvY3VtZW50IiwicmVhZHkiLCJnZXQiLCJkYXRhIiwiaSIsImxlbmd0aCIsIm9iaiIsIm5hbWUiLCJsYXQiLCJsYXRpdHVkZSIsImxvbmciLCJsb25naXR1ZGUiLCJwdXNoIiwibWFwIiwic2V0VmlldyIsInRpbGVMYXllciIsIm1heFpvb20iLCJhdHRyaWJ1dGlvbiIsImFkZFRvIiwiYmluZFBvcHVwIiwic2VhcmNoRGl2IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImRpc3BsYXkiLCJzZWFyY2hPcHQiLCJhZGRFdmVudExpc3RlbmVyIiwiaGlkZGVuIiwiZHJvcER3bkNvbnRlbnQiLCJzZWFyY2hCdCIsInJhZGlvT3B0IiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJwcmV2IiwiY2hlY2tlZCIsImNvbnNvbGUiLCJsb2ciLCJ2YWx1ZSIsInBsYWNlaG9sZGVyIiwiY2xlYXJMYXllcnMiLCJwcyIsInAiLCJzZWFyY2giLCJkZXNpZ25hdGlvbiIsImNvbG9yIiwidmFyaWV0eSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUMsR0FBQ0MsbUJBQU8sQ0FBQywyREFBRCxDQUFiOztBQUNBLElBQUlDLENBQUMsR0FBR0QsbUJBQU8sQ0FBQyxvREFBRCxDQUFmLEMsQ0FFQTs7O0FBQ0EsT0FBT0QsQ0FBQyxDQUFDRyxJQUFGLENBQU9DLE9BQVAsQ0FBZUMsU0FBZixDQUF5QkMsV0FBaEM7QUFDQU4sQ0FBQyxDQUFDRyxJQUFGLENBQU9DLE9BQVAsQ0FBZUcs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QUFDSjtBQUNKLFNBNUREO0FBNkRIO0FBcEVzQzs7QUFLM0MsU0FBSyxJQUFJSCxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHeUIsUUFBUSxDQUFDeEIsTUFBN0IsRUFBcUNELEdBQUMsRUFBdEMsRUFBMEM7QUFBQSxZQUFqQ0EsR0FBaUM7QUFnRXpDO0FBQ0osR0F0RUQ7QUF1RUgsQ0FoSkwsRSIsImZpbGUiOiJsZWFmbGV0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IEw9cmVxdWlyZSgnbGVhZmxldCcpO1xyXG5sZXQgJCA9IHJlcXVpcmUoJ2pxdWVyeScpO1xyXG5cclxuLy90aGlzIGZpeGVzIGEgbGVhZmxldCBidWcgdGhhdCBkb2VzIG5vdCBpbXBvcnQgdGhlIG1hcmtlciBpbWFnZXMgaWYgd2UgZG9uJ3QgYWRkIHRob3NlIGxpbmVzXHJcbmRlbGV0ZSBMLkljb24uRGVmYXVsdC5wcm90b3R5cGUuX2dldEljb25Vcmw7XHJcbkwuSWNvbi5EZWZhdWx0Lm1lcmdlT3B0aW9ucyh7XHJcbiAgICBpY29uUmV0aW5hVXJsOiByZXF1aXJlKCdsZWFmbGV0L2Rpc3QvaW1hZ2VzL21hcmtlci1pY29uLTJ4LnBuZycpLFxyXG4gICAgaWNvblVybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi5wbmcnKSxcclxuICAgIHNoYWRvd1VybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItc2hhZG93LnBuZycpLFxyXG59KTtcclxuXHJcbmxldCBwcm9kdWNlcnMgPSBbXTtcclxubGV0IHByb2R1Y2VyID0ge307XHJcbmxldCBteW1hcDtcclxubGV0IGxheWVyR3JvdXA7XHJcbmxldCBtYXJrZXI7XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAkLmdldChcImh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvcHJvZHVjZXJzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IG9iai5uYW1lO1xyXG4gICAgICAgICAgICBsZXQgbGF0ID0gb2JqLmxhdGl0dWRlO1xyXG4gICAgICAgICAgICBsZXQgbG9uZyA9IG9iai5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgIGxldCBwcm9kdWNlciA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG9iai5uYW1lLFxyXG4gICAgICAgICAgICAgICAgbGF0OiBvYmoubGF0aXR1ZGUsXHJcbiAgICAgICAgICAgICAgICBsb25nOiBvYmoubG9uZ2l0dWRlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHByb2R1Y2Vycy5wdXNoKHByb2R1Y2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbXltYXAgPSBMLm1hcCgnbWFwaWQnKS5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgNik7XHJcbiAgICAgICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vbWFwcy5oZWlnaXQub3JnL29wZW5tYXBzdXJmZXIvdGlsZXMvcm9hZHMvd2VibWVyY2F0b3Ive3p9L3t4fS97eX0ucG5nJywge1xyXG4gICAgICAgICAgICBtYXhab29tOiAxOSxcclxuICAgICAgICAgICAgYXR0cmlidXRpb246ICdJbWFnZXJ5IGZyb20gPGEgaHJlZj1cImh0dHA6Ly9naXNjaWVuY2UudW5pLWhkLmRlL1wiPkdJU2NpZW5jZSBSZXNlYXJjaCBHcm91cCBAIFVuaXZlcnNpdHkgb2YgSGVpZGVsYmVyZzwvYT4gfCBNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodFwiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycydcclxuICAgICAgICB9KS5hZGRUbyhteW1hcCk7XHJcblxyXG4gICAgICAgIGxheWVyR3JvdXAgPSBMLmxheWVyR3JvdXAoKS5hZGRUbyhteW1hcCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9kdWNlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3Byb2R1Y2Vyc1tpXS5sYXQsIHByb2R1Y2Vyc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHJvZHVjZXJzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHNlYXJjaERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoXCIpO1xyXG4gICAgc2VhcmNoRGl2LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIGxldCBzZWFyY2hPcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaE9wdFwiKTtcclxuXHJcbiAgICBzZWFyY2hPcHQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWFyY2hEaXYuaGlkZGVuID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgZHJvcER3bkNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRyb3Bkb3duLWNvbnRlbnRcIik7XHJcblxyXG4gICAgc2VhcmNoT3B0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VhcmNoRGl2LnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xyXG4gICAgICAgIHNlYXJjaE9wdC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgZHJvcER3bkNvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tU1RVRkZTIFRPIEZJTFRFUiBTRUFSQ0ggT04gTUFQLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbiAgICBsZXQgc2VhcmNoQnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaEJ0XCIpOyAvL2xlIGJvdXR0b24gcmVjaGVyY2hlclxyXG4gICAgbGV0IHJhZGlvT3B0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoJ3NlYXJjaE9wdGlvbicpOyAvL2xlIHJhZGlvIGJ0IGNob3NlbiBieSB1c2VyIHRvIGZpbHRlciBieVxyXG5cclxuICAgIC8qLS0tLSBjb250cm9scyB0aGUgcGxhY2Vob2xkZXIgb2YgdGhlIHNlYXJjaCBiYXIgd2hlbiBwaWNraW5nIGRpZmZlcmVudCBmaWx0ZXJpbmcgb3B0aW9ucyBmcm9tIHRoZSByYWRpbyBidXR0b25zIC0tLS0qL1xyXG4gICAgbGV0IHByZXYgPSBudWxsO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpb09wdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJhZGlvT3B0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyhwcmV2KSA/IGNvbnNvbGUubG9nKHByZXYudmFsdWUpOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcyAhPT0gcHJldikge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHJhZGlvT3B0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyYWRpbyBjaGVja2VkID0gXCIgKyByYWRpb09wdFtpXS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiYXBwZWxsYXRpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnBsYWNlaG9sZGVyID0gJ0VudHJleiB1biBub20gZFxcJ2FwcGVsbGF0aW9uJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY291bGV1clwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikucGxhY2Vob2xkZXIgPSAnRW50cmV6IHVuZSBjb3VsZXVyJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY2VwYWdlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS5wbGFjZWhvbGRlciA9ICdFbnRyZXogdW4gbm9tIGRlIGPDqXBhZ2UnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnZhbHVlKVxyXG4gICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgICAgIHNlYXJjaEJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxheWVyR3JvdXAuY2xlYXJMYXllcnMoKTtcclxuICAgICAgICAgICAgbGV0IHBzID0gW107XHJcbiAgICAgICAgICAgIGxldCBwID0ge307XHJcbiAgICAgICAgICAgIGxldCBzZWFyY2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnZhbHVlOyAvL2NlIHF1J2EgZWNyaXQgbCd1dGlsaXNhdGV1ciBkYW5zIGxhIGJhcnJlIGRlIHJlY2hlcmNoZVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhZGlvT3B0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZ2V0KFwiaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS93aW5lc1wiLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiYXBwZWxsYXRpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBvYmouZGVzaWduYXRpb24ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5BTUUgPSBcIiArIG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlYXJjaCA9PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubmFtZSA9IG9iai5wcm9kdWNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sYXQgPSBvYmoucHJvZHVjZXIubGF0aXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubG9uZyA9IG9iai5wcm9kdWNlci5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxvbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcy5wdXNoKHApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBMLm1hcmtlcihbcHNbaV0ubGF0LCBwc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGEgaHJlZj0nL2luZm9fd2luZXJ5Jz48Yj5Eb21haW5lPC9iPjxicj5cIiArIHBzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNvdWxldXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gb2JqLmNvbG9yLmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ09MT1IgPSBcIiArIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2ggPT0gY29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sYXQgPSBvYmoucHJvZHVjZXIubGF0aXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sYXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxvbmcgPSBvYmoucHJvZHVjZXIubG9uZ2l0dWRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY2VwYWdlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YXJpZXR5ID0gb2JqLnZhcmlldHkubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2ggPT0gdmFyaWV0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLm5hbWUgPSBvYmoucHJvZHVjZXIubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubG9uZyA9IG9iai5wcm9kdWNlci5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sb25nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHMucHVzaChwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3BzW2ldLmxhdCwgcHNbaV0ubG9uZ10pLmFkZFRvKGxheWVyR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLmJpbmRQb3B1cChcIjxhIGhyZWY9Jy9pbmZvX3dpbmVyeSc+PGI+RG9tYWluZTwvYj48YnI+XCIgKyBwc1tpXS5uYW1lICsgXCI8L2E+XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=
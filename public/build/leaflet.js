(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["leaflet"],{

/***/ "./assets/js/leaflet.js":
/*!******************************!*\
  !*** ./assets/js/leaflet.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.map */ "./node_modules/core-js/modules/es.array.map.js");

__webpack_require__(/*! core-js/modules/es.function.name */ "./node_modules/core-js/modules/es.function.name.js");

__webpack_require__(/*! core-js/modules/es.string.trim */ "./node_modules/core-js/modules/es.string.trim.js");

var L = __webpack_require__(/*! leaflet */ "./node_modules/leaflet/dist/leaflet-src.js");

var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js"); //this fixes a leaflet bug that does not import the marker images if we don't add those lines


delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon-2x.png */ "./node_modules/leaflet/dist/images/marker-icon-2x.png"),
  iconUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon.png */ "./node_modules/leaflet/dist/images/marker-icon.png"),
  shadowUrl: __webpack_require__(/*! leaflet/dist/images/marker-shadow.png */ "./node_modules/leaflet/dist/images/marker-shadow.png")
});
var producers = [];
var producer = {};
var mymap;
var layerGroup;
var marker;
var bigmapheight = 600;
var smallmapheight = 300;
var mapbreakwidth = 720;
var highzoom = 6;
var lowzoom = 4;
var initzoom;
$(document).ready(function () {
  $.get("http://127.0.0.1:8000/api/producers", function (data) {
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      var _producer = {
        name: obj.name,
        lat: obj.latitude,
        "long": obj.longitude,
        website: obj.website
      };
      producers.push(_producer);
    }

    if ($("#mapid").width() > mapbreakwidth) {
      initzoom = highzoom;
      $("#mapid").height(bigmapheight);
    } else {
      initzoom = lowzoom;
      $("#mapid").height(smallmapheight);
    }

    ;
    mymap = L.map('mapid', {
      minZoom: 5,
      maxZoom: 8
    }).setView([46.227638, 2.213749], initzoom);
    L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);
    layerGroup = L.layerGroup().addTo(mymap);

    for (var _i = 0; _i < producers.length; _i++) {
      marker = L.marker([producers[_i].lat, producers[_i]["long"]]).addTo(layerGroup);

      if (producers[_i].website != "") {
        marker.bindPopup("<a target=\"_blank\" href=" + producers[_i].website + "><b>Domaine</b><br>" + producers[_i].name + "</a>");
      } else {
        marker.bindPopup("<b>Domaine</b><br>" + producers[_i].name);
      }
    }
  }); // listen for screen resize events and changes map size and zoom accordingly

  window.addEventListener('resize', function (event) {
    if ($("#mapid").width() > mapbreakwidth) {
      initzoom = highzoom;
      $("#mapid").height(bigmapheight);
      mymap.setView([46.227638, 2.213749], initzoom);
    } else {
      initzoom = lowzoom;
      $("#mapid").height(smallmapheight);
      mymap.setView([46.227638, 2.213749], initzoom);
    }

    ;
  });
  var searchDiv = document.getElementById("search");
  searchDiv.style.display = "none";
  var searchOpt = document.getElementById("searchOpt");
  searchOpt.addEventListener("click", function () {
    searchDiv.hidden = false;
  });
  var dropDwnContent = document.getElementById("dropdown-content");
  searchOpt.addEventListener("click", function () {
    searchDiv.style.display = "inline";
    searchOpt.style.display = "none";
    dropDwnContent.style.display = "none";
  });
  /*----------------------------STUFFS TO FILTER SEARCH ON MAP-------------------------------*/

  var searchBt = document.getElementById("searchBt"); //le boutton rechercher

  var radioOpt = document.getElementsByName('searchOption'); //le radio bt chosen by user to filter by

  var resNotDFound = document.getElementById('notFound');
  /*....controls the placeholder of the search bar when picking different filtering options from the radio buttons ....*/

  var prev = null;

  for (var i = 0; i < radioOpt.length; i++) {
    radioOpt[i].addEventListener('change', function () {
      //(prev) ? console.log(prev.value): null;
      if (this !== prev) {
        prev = this;
      }

      for (var _i2 = 0, length = radioOpt.length; _i2 < length; _i2++) {
        if (radioOpt[_i2].checked) {
          //console.log("radio checked = " + radioOpt[i].value);
          if (radioOpt[_i2].value === "appellation") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom d\'appellation';
          }

          if (radioOpt[_i2].value === "couleur") {
            document.getElementById("searchQuery").placeholder = 'Entrez une couleur';
          }

          if (radioOpt[_i2].value === "cepage") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom de cépage';
          }
        } //console.log(this.value)

      }
    });
  }
  /*.............................................................................................................*/


  searchBt.addEventListener("click", function () {
    layerGroup.clearLayers();
    var ps = [];
    var p = {};
    var search = document.getElementById("searchQuery").value; //ce qu'a ecrit l'utilisateur dans la barre de recherche

    var _loop = function _loop(_i3) {
      if (radioOpt[_i3].checked) {
        $.get("http://127.0.0.1:8000/api/wines", function (data) {
          if (radioOpt[_i3].value === "appellation") {
            for (var _i4 = 0; _i4 < data.length; _i4++) {
              var obj = data[_i4];
              console.log("DATA[i] = " + data[_i4]);
              var name = obj.designation.name;

              if (search.toLowerCase().trim() == name.toLowerCase().trim()) {
                p.name = obj.producer.name; //console.log("name found = " + p.name);

                p.lat = obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i5 = 0; _i5 < ps.length; _i5++) {
                  marker = L.marker([ps[_i5].lat, ps[_i5]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i5].name + "</a>");
                }
              }
            }

            if (ps.length == 0) {
              resNotDFound.innerText = "Pas de résultats.";
            }
          }

          if (radioOpt[_i3].value === "couleur") {
            for (var _i6 = 0; _i6 < data.length; _i6++) {
              var _obj = data[_i6];
              var color = _obj.color.color; //console.log("COLOR = " + color);

              if (search.toLowerCase().trim() == color.toLowerCase().trim()) {
                p.name = _obj.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i7 = 0; _i7 < ps.length; _i7++) {
                  marker = L.marker([ps[_i7].lat, ps[_i7]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i7].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "cepage") {
            for (var _i8 = 0; _i8 < data.length; _i8++) {
              var _obj2 = data[_i8];
              var variety = _obj2.variety.name;

              if (search.toLowerCase().trim() == variety.toLowerCase().trim()) {
                p.name = _obj2.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj2.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj2.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i9 = 0; _i9 < ps.length; _i9++) {
                  marker = L.marker([ps[_i9].lat, ps[_i9]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i9].name + "</a>");
                }
              }
            }
          }
        });
      }
    };

    for (var _i3 = 0; _i3 < radioOpt.length; _i3++) {
      _loop(_i3);
    }
  });
}); // The Leaflet L.Map class provides the fitBounds method to zoom a map to contain a rectangular bounding box.
// The L.latLngBounds utility function creates a bounding box object from an array of latitude and longitude coordinates.
// With a single marker, however, we only have one latitude and longitude coordinate from which to create the bounding box.
// The solution is to create a single-element array containing the latitude and longitude coordinate of the marker.
// The following function centers and zooms a leaflet map on a single marker. Line 2 creates the single-element array containing
// the latitude and longitude coordinate of the marker. Line 3 creates the bounding box that encloses the marker’s location. Finally,
// line 4 zooms the map to enclose the bounding box.
// function centerLeafletMapOnMarker(map, marker) {
//     var latLngs = [ marker.getLatLng() ];
//     var markerBounds = L.latLngBounds(latLngs);
//     map.fitBounds(markerBounds);
// }

/***/ })

},[["./assets/js/leaflet.js","runtime","vendors~leaflet"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvbGVhZmxldC5qcyJdLCJuYW1lcyI6WyJMIiwicmVxdWlyZSIsIiQiLCJJY29uIiwiRGVmYXVsdCIsInByb3RvdHlwZSIsIl9nZXRJY29uVXJsIiwibWVyZ2VPcHRpb25zIiwiaWNvblJldGluYVVybCIsImljb25VcmwiLCJzaGFkb3dVcmwiLCJwcm9kdWNlcnMiLCJwcm9kdWNlciIsIm15bWFwIiwibGF5ZXJHcm91cCIsIm1hcmtlciIsImJpZ21hcGhlaWdodCIsInNtYWxsbWFwaGVpZ2h0IiwibWFwYnJlYWt3aWR0aCIsImhpZ2h6b29tIiwibG93em9vbSIsImluaXR6b29tIiwiZG9jdW1lbnQiLCJyZWFkeSIsImdldCIsImRhdGEiLCJpIiwibGVuZ3RoIiwib2JqIiwibmFtZSIsImxhdCIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwid2Vic2l0ZSIsInB1c2giLCJ3aWR0aCIsImhlaWdodCIsIm1hcCIsIm1pblpvb20iLCJtYXhab29tIiwic2V0VmlldyIsInRpbGVMYXllciIsImF0dHJpYnV0aW9uIiwiYWRkVG8iLCJiaW5kUG9wdXAiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJzZWFyY2hEaXYiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiZGlzcGxheSIsInNlYXJjaE9wdCIsImhpZGRlbiIsImRyb3BEd25Db250ZW50Iiwic2VhcmNoQnQiLCJyYWRpb09wdCIsImdldEVsZW1lbnRzQnlOYW1lIiwicmVzTm90REZvdW5kIiwicHJldiIsImNoZWNrZWQiLCJ2YWx1ZSIsInBsYWNlaG9sZGVyIiwiY2xlYXJMYXllcnMiLCJwcyIsInAiLCJzZWFyY2giLCJjb25zb2xlIiwibG9nIiwiZGVzaWduYXRpb24iLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJpbm5lclRleHQiLCJjb2xvciIsInZhcmlldHkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUMsR0FBQ0Ms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QSxxQkFBSyxJQUFJdkMsR0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBR3NDLEVBQUUsQ0FBQ3JDLE1BQXZCLEVBQStCRCxHQUFDLEVBQWhDLEVBQW9DO0FBQ2hDWCx3QkFBTSxHQUFHZixDQUFDLENBQUNlLE1BQUYsQ0FBUyxDQUFDaUQsRUFBRSxDQUFDdEMsR0FBRCxDQUFGLENBQU1JLEdBQVAsRUFBWWtDLEVBQUUsQ0FBQ3RDLEdBQUQsQ0FBRixRQUFaLENBQVQsRUFBa0NpQixLQUFsQyxDQUF3QzdCLFVBQXhDLENBQVQ7QUFDQUMsd0JBQU0sQ0FBQzZCLFNBQVAsQ0FBaUIsOENBQThDb0IsRUFBRSxDQUFDdEMsR0FBRCxDQUFGLENBQU1HLElBQXBELEdBQTJELE1BQTVFO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSixTQS9ERDtBQWdFSDtBQXZFc0M7O0FBSzNDLFNBQUssSUFBSUgsR0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBRzhCLFFBQVEsQ0FBQzdCLE1BQTdCLEVBQXFDRCxHQUFDLEVBQXRDLEVBQTBDO0FBQUEsWUFBakNBLEdBQWlDO0FBbUV6QztBQUNKLEdBekVEO0FBMEVILENBL0tMLEUsQ0FpTEE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEkiLCJmaWxlIjoibGVhZmxldC5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBMPXJlcXVpcmUoJ2xlYWZsZXQnKTtcclxubGV0ICQgPSByZXF1aXJlKCdqcXVlcnknKTtcclxuXHJcbi8vdGhpcyBmaXhlcyBhIGxlYWZsZXQgYnVnIHRoYXQgZG9lcyBub3QgaW1wb3J0IHRoZSBtYXJrZXIgaW1hZ2VzIGlmIHdlIGRvbid0IGFkZCB0aG9zZSBsaW5lc1xyXG5kZWxldGUgTC5JY29uLkRlZmF1bHQucHJvdG90eXBlLl9nZXRJY29uVXJsO1xyXG5MLkljb24uRGVmYXVsdC5tZXJnZU9wdGlvbnMoe1xyXG4gICAgaWNvblJldGluYVVybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi0yeC5wbmcnKSxcclxuICAgIGljb25Vcmw6IHJlcXVpcmUoJ2xlYWZsZXQvZGlzdC9pbWFnZXMvbWFya2VyLWljb24ucG5nJyksXHJcbiAgICBzaGFkb3dVcmw6IHJlcXVpcmUoJ2xlYWZsZXQvZGlzdC9pbWFnZXMvbWFya2VyLXNoYWRvdy5wbmcnKSxcclxufSk7XHJcblxyXG5sZXQgcHJvZHVjZXJzID0gW107XHJcbmxldCBwcm9kdWNlciA9IHt9O1xyXG5sZXQgbXltYXA7XHJcbmxldCBsYXllckdyb3VwO1xyXG5sZXQgbWFya2VyO1xyXG52YXIgYmlnbWFwaGVpZ2h0ID0gNjAwO1xyXG52YXIgc21hbGxtYXBoZWlnaHQgPSAzMDA7XHJcbnZhciBtYXBicmVha3dpZHRoID0gNzIwO1xyXG52YXIgaGlnaHpvb20gPSA2O1xyXG52YXIgbG93em9vbSA9IDQ7XHJcbnZhciBpbml0em9vbTtcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICQuZ2V0KFwiaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS9wcm9kdWNlcnNcIiwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG9iaiA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgIGxldCBwcm9kdWNlciA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG9iai5uYW1lLFxyXG4gICAgICAgICAgICAgICAgbGF0OiBvYmoubGF0aXR1ZGUsXHJcbiAgICAgICAgICAgICAgICBsb25nOiBvYmoubG9uZ2l0dWRlLFxyXG4gICAgICAgICAgICAgICAgd2Vic2l0ZTogb2JqLndlYnNpdGVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcHJvZHVjZXJzLnB1c2gocHJvZHVjZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCQoXCIjbWFwaWRcIikud2lkdGgoKSA+IG1hcGJyZWFrd2lkdGgpIHtcclxuICAgICAgICAgICAgaW5pdHpvb20gPSBoaWdoem9vbTtcclxuICAgICAgICAgICAgJChcIiNtYXBpZFwiKS5oZWlnaHQoYmlnbWFwaGVpZ2h0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluaXR6b29tID0gbG93em9vbTtcclxuICAgICAgICAgICAgJChcIiNtYXBpZFwiKS5oZWlnaHQoc21hbGxtYXBoZWlnaHQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIG15bWFwID0gTC5tYXAoJ21hcGlkJywge21pblpvb206IDUsIG1heFpvb206IDh9KS5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgaW5pdHpvb20gKTtcclxuICAgICAgICBMLnRpbGVMYXllcignaHR0cHM6Ly9tYXBzLmhlaWdpdC5vcmcvb3Blbm1hcHN1cmZlci90aWxlcy9yb2Fkcy93ZWJtZXJjYXRvci97en0ve3h9L3t5fS5wbmcnLCB7XHJcbiAgICAgICAgICAgIG1heFpvb206IDE5LFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGlvbjogJ0ltYWdlcnkgZnJvbSA8YSBocmVmPVwiaHR0cDovL2dpc2NpZW5jZS51bmktaGQuZGUvXCI+R0lTY2llbmNlIFJlc2VhcmNoIEdyb3VwIEAgVW5pdmVyc2l0eSBvZiBIZWlkZWxiZXJnPC9hPiB8IE1hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJ1xyXG4gICAgICAgIH0pLmFkZFRvKG15bWFwKTtcclxuXHJcbiAgICAgICAgbGF5ZXJHcm91cCA9IEwubGF5ZXJHcm91cCgpLmFkZFRvKG15bWFwKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2R1Y2Vycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBtYXJrZXIgPSBMLm1hcmtlcihbcHJvZHVjZXJzW2ldLmxhdCwgcHJvZHVjZXJzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgaWYocHJvZHVjZXJzW2ldLndlYnNpdGUgIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgbWFya2VyLmJpbmRQb3B1cChcIjxhIHRhcmdldD1cXFwiX2JsYW5rXFxcIiBocmVmPVwiICsgcHJvZHVjZXJzW2ldLndlYnNpdGUgKyBcIj48Yj5Eb21haW5lPC9iPjxicj5cIiArIHByb2R1Y2Vyc1tpXS5uYW1lICsgXCI8L2E+XCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWFya2VyLmJpbmRQb3B1cChcIjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHJvZHVjZXJzW2ldLm5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gbGlzdGVuIGZvciBzY3JlZW4gcmVzaXplIGV2ZW50cyBhbmQgY2hhbmdlcyBtYXAgc2l6ZSBhbmQgem9vbSBhY2NvcmRpbmdseVxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCQoXCIjbWFwaWRcIikud2lkdGgoKSA+IG1hcGJyZWFrd2lkdGgpIHtcclxuICAgICAgICAgICAgaW5pdHpvb20gPSBoaWdoem9vbTtcclxuICAgICAgICAgICAgJChcIiNtYXBpZFwiKS5oZWlnaHQoYmlnbWFwaGVpZ2h0KTtcclxuICAgICAgICAgICAgbXltYXAuc2V0VmlldyhbNDYuMjI3NjM4LCAyLjIxMzc0OV0sIGluaXR6b29tICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpbml0em9vbSA9IGxvd3pvb207XHJcbiAgICAgICAgICAgICQoXCIjbWFwaWRcIikuaGVpZ2h0KHNtYWxsbWFwaGVpZ2h0KTtcclxuICAgICAgICAgICAgbXltYXAuc2V0VmlldyhbNDYuMjI3NjM4LCAyLjIxMzc0OV0sIGluaXR6b29tICk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBzZWFyY2hEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFwiKTtcclxuICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICBsZXQgc2VhcmNoT3B0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hPcHRcIik7XHJcblxyXG4gICAgc2VhcmNoT3B0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VhcmNoRGl2LmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGRyb3BEd25Db250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkcm9wZG93bi1jb250ZW50XCIpO1xyXG5cclxuICAgIHNlYXJjaE9wdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlYXJjaERpdi5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcclxuICAgICAgICBzZWFyY2hPcHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIGRyb3BEd25Db250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVNUVUZGUyBUTyBGSUxURVIgU0VBUkNIIE9OIE1BUC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgbGV0IHNlYXJjaEJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hCdFwiKTsgLy9sZSBib3V0dG9uIHJlY2hlcmNoZXJcclxuICAgIGxldCByYWRpb09wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCdzZWFyY2hPcHRpb24nKTsgLy9sZSByYWRpbyBidCBjaG9zZW4gYnkgdXNlciB0byBmaWx0ZXIgYnlcclxuICAgIGxldCByZXNOb3RERm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90Rm91bmQnKTtcclxuXHJcbiAgICAvKi4uLi5jb250cm9scyB0aGUgcGxhY2Vob2xkZXIgb2YgdGhlIHNlYXJjaCBiYXIgd2hlbiBwaWNraW5nIGRpZmZlcmVudCBmaWx0ZXJpbmcgb3B0aW9ucyBmcm9tIHRoZSByYWRpbyBidXR0b25zIC4uLi4qL1xyXG4gICAgbGV0IHByZXYgPSBudWxsO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpb09wdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJhZGlvT3B0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyhwcmV2KSA/IGNvbnNvbGUubG9nKHByZXYudmFsdWUpOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcyAhPT0gcHJldikge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHJhZGlvT3B0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJhZGlvIGNoZWNrZWQgPSBcIiArIHJhZGlvT3B0W2ldLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikucGxhY2Vob2xkZXIgPSAnRW50cmV6IHVuIG5vbSBkXFwnYXBwZWxsYXRpb24nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjb3VsZXVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS5wbGFjZWhvbGRlciA9ICdFbnRyZXogdW5lIGNvdWxldXInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjZXBhZ2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnBsYWNlaG9sZGVyID0gJ0VudHJleiB1biBub20gZGUgY8OpcGFnZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudmFsdWUpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyouLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uKi9cclxuXHJcbiAgICAgICAgc2VhcmNoQnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGF5ZXJHcm91cC5jbGVhckxheWVycygpO1xyXG4gICAgICAgICAgICBsZXQgcHMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHAgPSB7fTtcclxuICAgICAgICAgICAgbGV0IHNlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikudmFsdWU7IC8vY2UgcXUnYSBlY3JpdCBsJ3V0aWxpc2F0ZXVyIGRhbnMgbGEgYmFycmUgZGUgcmVjaGVyY2hlXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFkaW9PcHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5nZXQoXCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3dpbmVzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJhcHBlbGxhdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRBVEFbaV0gPSBcIiArIGRhdGFbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gb2JqLmRlc2lnbmF0aW9uLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoLnRvTG93ZXJDYXNlKCkudHJpbSgpID09IG5hbWUudG9Mb3dlckNhc2UoKS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzTm90REZvdW5kLmlubmVyVGV4dCA9IFwiUGFzIGRlIHLDqXN1bHRhdHMuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY291bGV1clwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBvYmouY29sb3IuY29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkNPTE9SID0gXCIgKyBjb2xvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoLnRvTG93ZXJDYXNlKCkudHJpbSgpID09IGNvbG9yLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubmFtZSA9IG9iai5wcm9kdWNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sYXQgPSBvYmoucHJvZHVjZXIubGF0aXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubG9uZyA9IG9iai5wcm9kdWNlci5sb25naXR1ZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLmxvbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcy5wdXNoKHApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBMLm1hcmtlcihbcHNbaV0ubGF0LCBwc1tpXS5sb25nXSkuYWRkVG8obGF5ZXJHcm91cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGEgaHJlZj0nL2luZm9fd2luZXJ5Jz48Yj5Eb21haW5lPC9iPjxicj5cIiArIHBzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNlcGFnZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWV0eSA9IG9iai52YXJpZXR5Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VhcmNoLnRvTG93ZXJDYXNlKCkudHJpbSgpID09IHZhcmlldHkudG9Mb3dlckNhc2UoKS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbi8vIFRoZSBMZWFmbGV0IEwuTWFwIGNsYXNzIHByb3ZpZGVzIHRoZSBmaXRCb3VuZHMgbWV0aG9kIHRvIHpvb20gYSBtYXAgdG8gY29udGFpbiBhIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIEwubGF0TG5nQm91bmRzIHV0aWxpdHkgZnVuY3Rpb24gY3JlYXRlcyBhIGJvdW5kaW5nIGJveCBvYmplY3QgZnJvbSBhbiBhcnJheSBvZiBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGVzLlxyXG4vLyBXaXRoIGEgc2luZ2xlIG1hcmtlciwgaG93ZXZlciwgd2Ugb25seSBoYXZlIG9uZSBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGUgZnJvbSB3aGljaCB0byBjcmVhdGUgdGhlIGJvdW5kaW5nIGJveC5cclxuLy8gVGhlIHNvbHV0aW9uIGlzIHRvIGNyZWF0ZSBhIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmcgdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLlxyXG5cclxuLy8gVGhlIGZvbGxvd2luZyBmdW5jdGlvbiBjZW50ZXJzIGFuZCB6b29tcyBhIGxlYWZsZXQgbWFwIG9uIGEgc2luZ2xlIG1hcmtlci4gTGluZSAyIGNyZWF0ZXMgdGhlIHNpbmdsZS1lbGVtZW50IGFycmF5IGNvbnRhaW5pbmdcclxuLy8gdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBvZiB0aGUgbWFya2VyLiBMaW5lIDMgY3JlYXRlcyB0aGUgYm91bmRpbmcgYm94IHRoYXQgZW5jbG9zZXMgdGhlIG1hcmtlcuKAmXMgbG9jYXRpb24uIEZpbmFsbHksXHJcbi8vIGxpbmUgNCB6b29tcyB0aGUgbWFwIHRvIGVuY2xvc2UgdGhlIGJvdW5kaW5nIGJveC5cclxuXHJcbi8vIGZ1bmN0aW9uIGNlbnRlckxlYWZsZXRNYXBPbk1hcmtlcihtYXAsIG1hcmtlcikge1xyXG4vLyAgICAgdmFyIGxhdExuZ3MgPSBbIG1hcmtlci5nZXRMYXRMbmcoKSBdO1xyXG4vLyAgICAgdmFyIG1hcmtlckJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGxhdExuZ3MpO1xyXG4vLyAgICAgbWFwLmZpdEJvdW5kcyhtYXJrZXJCb3VuZHMpO1xyXG4vLyB9XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=
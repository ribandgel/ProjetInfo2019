(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["leaflet"],{

/***/ "./assets/js/leaflet.js":
/*!******************************!*\
  !*** ./assets/js/leaflet.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.map */ "./node_modules/core-js/modules/es.array.map.js");

__webpack_require__(/*! core-js/modules/es.function.name */ "./node_modules/core-js/modules/es.function.name.js");

__webpack_require__(/*! core-js/modules/es.string.trim */ "./node_modules/core-js/modules/es.string.trim.js");

var L = __webpack_require__(/*! leaflet */ "./node_modules/leaflet/dist/leaflet-src.js");

var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js"); //this fixes a leaflet bug that does not import the marker images if we don't add those lines


delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon-2x.png */ "./node_modules/leaflet/dist/images/marker-icon-2x.png"),
  iconUrl: __webpack_require__(/*! leaflet/dist/images/marker-icon.png */ "./node_modules/leaflet/dist/images/marker-icon.png"),
  shadowUrl: __webpack_require__(/*! leaflet/dist/images/marker-shadow.png */ "./node_modules/leaflet/dist/images/marker-shadow.png")
});
var producers = [];
var producer = {};
var mymap;
var layerGroup;
var marker;
var bigmapheight = 500;
var smallmapheight = 300;
var mapbreakwidth = 720;
var highzoom = 6;
var lowzoom = 4;
var initzoom;
document.getElementById("nav-map").setAttribute("class", "active");
$(document).ready(function () {
  $.get("http://127.0.0.1:8000/api/producers", function (data) {
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      var _producer = {
        name: obj.name,
        lat: obj.latitude,
        "long": obj.longitude,
        website: obj.website
      };
      producers.push(_producer);
    }

    if ($("#mapid").width() > mapbreakwidth) {
      initzoom = highzoom;
      $("#mapid").height(bigmapheight);
    } else {
      initzoom = lowzoom;
      $("#mapid").height(smallmapheight);
    }

    ;
    mymap = L.map('mapid', {
      minZoom: 5,
      maxZoom: 8
    }).setView([46.227638, 2.213749], initzoom);
    L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> | Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);
    layerGroup = L.layerGroup().addTo(mymap);

    for (var _i = 0; _i < producers.length; _i++) {
      marker = L.marker([producers[_i].lat, producers[_i]["long"]]).addTo(layerGroup);

      if (producers[_i].website != "") {
        marker.bindPopup("<a target=\"_blank\" href=" + producers[_i].website + "><b>Domaine</b><br>" + producers[_i].name + "</a>");
      } else {
        marker.bindPopup("<b>Domaine</b><br>" + producers[_i].name);
      }
    }
  }); // listen for screen resize events and changes map size and zoom accordingly

  window.addEventListener('resize', function (event) {
    if ($("#mapid").width() > mapbreakwidth) {
      initzoom = highzoom;
      $("#mapid").height(bigmapheight);
      mymap.setView([46.227638, 2.213749], initzoom);
    } else {
      initzoom = lowzoom;
      $("#mapid").height(smallmapheight);
      mymap.setView([46.227638, 2.213749], initzoom);
    }

    ;
  });
  var searchDiv = document.getElementById("search");
  searchDiv.style.display = "none";
  var searchOpt = document.getElementById("searchOpt");
  searchOpt.addEventListener("click", function () {
    searchDiv.hidden = false;
  });
  var dropDwnContent = document.getElementById("dropdown-content");
  searchOpt.addEventListener("click", function () {
    searchDiv.style.display = "inline";
    searchOpt.style.display = "none";
    dropDwnContent.style.display = "none";
  });
  /*----------------------------STUFFS TO FILTER SEARCH ON MAP-------------------------------*/

  var searchBt = document.getElementById("searchBt"); //le boutton rechercher

  var radioOpt = document.getElementsByName('searchOption'); //le radio bt chosen by user to filter by

  var resNotDFound = document.getElementById('notFound');
  /*....controls the placeholder of the search bar when picking different filtering options from the radio buttons ....*/

  var prev = null;

  for (var i = 0; i < radioOpt.length; i++) {
    radioOpt[i].addEventListener('change', function () {
      //(prev) ? console.log(prev.value): null;
      if (this !== prev) {
        prev = this;
      }

      for (var _i2 = 0, length = radioOpt.length; _i2 < length; _i2++) {
        if (radioOpt[_i2].checked) {
          //console.log("radio checked = " + radioOpt[i].value);
          if (radioOpt[_i2].value === "appellation") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom d\'appellation';
          }

          if (radioOpt[_i2].value === "couleur") {
            document.getElementById("searchQuery").placeholder = 'Entrez une couleur';
          }

          if (radioOpt[_i2].value === "cepage") {
            document.getElementById("searchQuery").placeholder = 'Entrez un nom de cépage';
          }
        } //console.log(this.value)

      }
    });
  }
  /*.............................................................................................................*/


  searchBt.addEventListener("click", function () {
    layerGroup.clearLayers();
    var ps = [];
    var p = {};
    var search = document.getElementById("searchQuery").value; //ce qu'a ecrit l'utilisateur dans la barre de recherche

    var _loop = function _loop(_i3) {
      if (radioOpt[_i3].checked) {
        $.get("http://127.0.0.1:8000/api/wines", function (data) {
          if (radioOpt[_i3].value === "appellation") {
            for (var _i4 = 0; _i4 < data.length; _i4++) {
              var obj = data[_i4];
              console.log("DATA[i] = " + data[_i4]);
              var name = obj.designation.name;

              if (search.toLowerCase().trim() == name.toLowerCase().trim()) {
                p.name = obj.producer.name; //console.log("name found = " + p.name);

                p.lat = obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i5 = 0; _i5 < ps.length; _i5++) {
                  marker = L.marker([ps[_i5].lat, ps[_i5]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i5].name + "</a>");
                }
              }
            }

            if (ps.length == 0) {
              resNotDFound.innerText = "Pas de résultats.";
            }
          }

          if (radioOpt[_i3].value === "couleur") {
            for (var _i6 = 0; _i6 < data.length; _i6++) {
              var _obj = data[_i6];
              var color = _obj.color.color; //console.log("COLOR = " + color);

              if (search.toLowerCase().trim() == color.toLowerCase().trim()) {
                p.name = _obj.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i7 = 0; _i7 < ps.length; _i7++) {
                  marker = L.marker([ps[_i7].lat, ps[_i7]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i7].name + "</a>");
                }
              }
            }
          }

          if (radioOpt[_i3].value === "cepage") {
            for (var _i8 = 0; _i8 < data.length; _i8++) {
              var _obj2 = data[_i8];
              var variety = _obj2.variety.name;

              if (search.toLowerCase().trim() == variety.toLowerCase().trim()) {
                p.name = _obj2.producer.name; //console.log("name found = " + p.name);

                p.lat = _obj2.producer.latitude; //console.log("name found = " + p.lat);

                p["long"] = _obj2.producer.longitude; //console.log("name found = " + p.long);

                ps.push(p);

                for (var _i9 = 0; _i9 < ps.length; _i9++) {
                  marker = L.marker([ps[_i9].lat, ps[_i9]["long"]]).addTo(layerGroup);
                  marker.bindPopup("<a href='/info_winery'><b>Domaine</b><br>" + ps[_i9].name + "</a>");
                }
              }
            }
          }
        });
      }
    };

    for (var _i3 = 0; _i3 < radioOpt.length; _i3++) {
      _loop(_i3);
    }
  });
}); // The Leaflet L.Map class provides the fitBounds method to zoom a map to contain a rectangular bounding box.
// The L.latLngBounds utility function creates a bounding box object from an array of latitude and longitude coordinates.
// With a single marker, however, we only have one latitude and longitude coordinate from which to create the bounding box.
// The solution is to create a single-element array containing the latitude and longitude coordinate of the marker.
// The following function centers and zooms a leaflet map on a single marker. Line 2 creates the single-element array containing
// the latitude and longitude coordinate of the marker. Line 3 creates the bounding box that encloses the marker’s location. Finally,
// line 4 zooms the map to enclose the bounding box.
// function centerLeafletMapOnMarker(map, marker) {
//     var latLngs = [ marker.getLatLng() ];
//     var markerBounds = L.latLngBounds(latLngs);
//     map.fitBounds(markerBounds);
// }

/***/ })

},[["./assets/js/leaflet.js","runtime","vendors~leaflet"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvbGVhZmxldC5qcyJdLCJuYW1lcyI6WyJMIiwicmVxdWlyZSIsIiQiLCJJY29uIiwiRGVmYXVsdCIsInByb3RvdHlwZSIsIl9nZXRJY29uVXJsIiwibWVyZ2VPcHRpb25zIiwiaWNvblJldGluYVVybCIsImljb25VcmwiLCJzaGFkb3dVcmwiLCJwcm9kdWNlcnMiLCJwcm9kdWNlciIsIm15bWFwIiwibGF5ZXJHcm91cCIsIm1hcmtlciIsImJpZ21hcGhlaWdodCIsInNtYWxsbWFwaGVpZ2h0IiwibWFwYnJlYWt3aWR0aCIsImhpZ2h6b29tIiwibG93em9vbSIsImluaXR6b29tIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNldEF0dHJpYnV0ZSIsInJlYWR5IiwiZ2V0IiwiZGF0YSIsImkiLCJsZW5ndGgiLCJvYmoiLCJuYW1lIiwibGF0IiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJ3ZWJzaXRlIiwicHVzaCIsIndpZHRoIiwiaGVpZ2h0IiwibWFwIiwibWluWm9vbSIsIm1heFpvb20iLCJzZXRWaWV3IiwidGlsZUxheWVyIiwiYXR0cmlidXRpb24iLCJhZGRUbyIsImJpbmRQb3B1cCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInNlYXJjaERpdiIsInN0eWxlIiwiZGlzcGxheSIsInNlYXJjaE9wdCIsImhpZGRlbiIsImRyb3BEd25Db250ZW50Iiwic2VhcmNoQnQiLCJyYWRpb09wdCIsImdldEVsZW1lbnRzQnlOYW1lIiwicmVzTm90REZvdW5kIiwicHJldiIsImNoZWNrZWQiLCJ2YWx1ZSIsInBsYWNlaG9sZGVyIiwiY2xlYXJMYXllcnMiLCJwcyIsInAiLCJzZWFyY2giLCJjb25zb2xlIiwibG9nIiwiZGVzaWduYXRpb24iLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJpbm5lclRleHQiLCJjb2xvciIsInZhcmlldHkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElB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QUFELEdBQVNwQyxLQUFHLENBQUNsQixRQUFKLENBQWFzQixTQUF0QixDQUw0RCxDQU01RDs7QUFDQStCLGtCQUFFLENBQUM3QixJQUFILENBQVE4QixDQUFSOztBQUNBLHFCQUFLLElBQUl0QyxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHcUMsRUFBRSxDQUFDcEMsTUFBdkIsRUFBK0JELEdBQUMsRUFBaEMsRUFBb0M7QUFDaENiLHdCQUFNLEdBQUdmLENBQUMsQ0FBQ2UsTUFBRixDQUFTLENBQUNrRCxFQUFFLENBQUNyQyxHQUFELENBQUYsQ0FBTUksR0FBUCxFQUFZaUMsRUFBRSxDQUFDckMsR0FBRCxDQUFGLFFBQVosQ0FBVCxFQUFrQ2lCLEtBQWxDLENBQXdDL0IsVUFBeEMsQ0FBVDtBQUNBQyx3QkFBTSxDQUFDK0IsU0FBUCxDQUFpQiw4Q0FBOENtQixFQUFFLENBQUNyQyxHQUFELENBQUYsQ0FBTUcsSUFBcEQsR0FBMkQsTUFBNUU7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKLFNBL0REO0FBZ0VIO0FBdkVzQzs7QUFLM0MsU0FBSyxJQUFJSCxHQUFDLEdBQUcsQ0FBYixFQUFnQkEsR0FBQyxHQUFHNkIsUUFBUSxDQUFDNUIsTUFBN0IsRUFBcUNELEdBQUMsRUFBdEMsRUFBMEM7QUFBQSxZQUFqQ0EsR0FBaUM7QUFtRXpDO0FBQ0osR0F6RUQ7QUEwRUgsQ0EvS0wsRSxDQWlMQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSSIsImZpbGUiOiJsZWFmbGV0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IEw9cmVxdWlyZSgnbGVhZmxldCcpO1xyXG5sZXQgJCA9IHJlcXVpcmUoJ2pxdWVyeScpO1xyXG5cclxuLy90aGlzIGZpeGVzIGEgbGVhZmxldCBidWcgdGhhdCBkb2VzIG5vdCBpbXBvcnQgdGhlIG1hcmtlciBpbWFnZXMgaWYgd2UgZG9uJ3QgYWRkIHRob3NlIGxpbmVzXHJcbmRlbGV0ZSBMLkljb24uRGVmYXVsdC5wcm90b3R5cGUuX2dldEljb25Vcmw7XHJcbkwuSWNvbi5EZWZhdWx0Lm1lcmdlT3B0aW9ucyh7XHJcbiAgICBpY29uUmV0aW5hVXJsOiByZXF1aXJlKCdsZWFmbGV0L2Rpc3QvaW1hZ2VzL21hcmtlci1pY29uLTJ4LnBuZycpLFxyXG4gICAgaWNvblVybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi5wbmcnKSxcclxuICAgIHNoYWRvd1VybDogcmVxdWlyZSgnbGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItc2hhZG93LnBuZycpLFxyXG59KTtcclxuXHJcbmxldCBwcm9kdWNlcnMgPSBbXTtcclxubGV0IHByb2R1Y2VyID0ge307XHJcbmxldCBteW1hcDtcclxubGV0IGxheWVyR3JvdXA7XHJcbmxldCBtYXJrZXI7XHJcbnZhciBiaWdtYXBoZWlnaHQgPSA1MDA7XHJcbnZhciBzbWFsbG1hcGhlaWdodCA9IDMwMDtcclxudmFyIG1hcGJyZWFrd2lkdGggPSA3MjA7XHJcbnZhciBoaWdoem9vbSA9IDY7XHJcbnZhciBsb3d6b29tID0gNDtcclxudmFyIGluaXR6b29tO1xyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXYtbWFwXCIpLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiYWN0aXZlXCIpO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgJC5nZXQoXCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3Byb2R1Y2Vyc1wiLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgb2JqID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgbGV0IHByb2R1Y2VyID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogb2JqLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsYXQ6IG9iai5sYXRpdHVkZSxcclxuICAgICAgICAgICAgICAgIGxvbmc6IG9iai5sb25naXR1ZGUsXHJcbiAgICAgICAgICAgICAgICB3ZWJzaXRlOiBvYmoud2Vic2l0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBwcm9kdWNlcnMucHVzaChwcm9kdWNlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoJChcIiNtYXBpZFwiKS53aWR0aCgpID4gbWFwYnJlYWt3aWR0aCkge1xyXG4gICAgICAgICAgICBpbml0em9vbSA9IGhpZ2h6b29tO1xyXG4gICAgICAgICAgICAkKFwiI21hcGlkXCIpLmhlaWdodChiaWdtYXBoZWlnaHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW5pdHpvb20gPSBsb3d6b29tO1xyXG4gICAgICAgICAgICAkKFwiI21hcGlkXCIpLmhlaWdodChzbWFsbG1hcGhlaWdodCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbXltYXAgPSBMLm1hcCgnbWFwaWQnLCB7bWluWm9vbTogNSwgbWF4Wm9vbTogOH0pLnNldFZpZXcoWzQ2LjIyNzYzOCwgMi4yMTM3NDldLCBpbml0em9vbSApO1xyXG4gICAgICAgIEwudGlsZUxheWVyKCdodHRwczovL21hcHMuaGVpZ2l0Lm9yZy9vcGVubWFwc3VyZmVyL3RpbGVzL3JvYWRzL3dlYm1lcmNhdG9yL3t6fS97eH0ve3l9LnBuZycsIHtcclxuICAgICAgICAgICAgbWF4Wm9vbTogMTksXHJcbiAgICAgICAgICAgIGF0dHJpYnV0aW9uOiAnSW1hZ2VyeSBmcm9tIDxhIGhyZWY9XCJodHRwOi8vZ2lzY2llbmNlLnVuaS1oZC5kZS9cIj5HSVNjaWVuY2UgUmVzZWFyY2ggR3JvdXAgQCBVbml2ZXJzaXR5IG9mIEhlaWRlbGJlcmc8L2E+IHwgTWFwIGRhdGEgJmNvcHk7IDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9jb3B5cmlnaHRcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMnXHJcbiAgICAgICAgfSkuYWRkVG8obXltYXApO1xyXG5cclxuICAgICAgICBsYXllckdyb3VwID0gTC5sYXllckdyb3VwKCkuYWRkVG8obXltYXApO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvZHVjZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwcm9kdWNlcnNbaV0ubGF0LCBwcm9kdWNlcnNbaV0ubG9uZ10pLmFkZFRvKGxheWVyR3JvdXApO1xyXG4gICAgICAgICAgICBpZihwcm9kdWNlcnNbaV0ud2Vic2l0ZSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGEgdGFyZ2V0PVxcXCJfYmxhbmtcXFwiIGhyZWY9XCIgKyBwcm9kdWNlcnNbaV0ud2Vic2l0ZSArIFwiPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHJvZHVjZXJzW2ldLm5hbWUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtYXJrZXIuYmluZFBvcHVwKFwiPGI+RG9tYWluZTwvYj48YnI+XCIgKyBwcm9kdWNlcnNbaV0ubmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBsaXN0ZW4gZm9yIHNjcmVlbiByZXNpemUgZXZlbnRzIGFuZCBjaGFuZ2VzIG1hcCBzaXplIGFuZCB6b29tIGFjY29yZGluZ2x5XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoJChcIiNtYXBpZFwiKS53aWR0aCgpID4gbWFwYnJlYWt3aWR0aCkge1xyXG4gICAgICAgICAgICBpbml0em9vbSA9IGhpZ2h6b29tO1xyXG4gICAgICAgICAgICAkKFwiI21hcGlkXCIpLmhlaWdodChiaWdtYXBoZWlnaHQpO1xyXG4gICAgICAgICAgICBteW1hcC5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgaW5pdHpvb20gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluaXR6b29tID0gbG93em9vbTtcclxuICAgICAgICAgICAgJChcIiNtYXBpZFwiKS5oZWlnaHQoc21hbGxtYXBoZWlnaHQpO1xyXG4gICAgICAgICAgICBteW1hcC5zZXRWaWV3KFs0Ni4yMjc2MzgsIDIuMjEzNzQ5XSwgaW5pdHpvb20gKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHNlYXJjaERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoXCIpO1xyXG4gICAgc2VhcmNoRGl2LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIGxldCBzZWFyY2hPcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaE9wdFwiKTtcclxuXHJcbiAgICBzZWFyY2hPcHQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWFyY2hEaXYuaGlkZGVuID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgZHJvcER3bkNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRyb3Bkb3duLWNvbnRlbnRcIik7XHJcblxyXG4gICAgc2VhcmNoT3B0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VhcmNoRGl2LnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xyXG4gICAgICAgIHNlYXJjaE9wdC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgZHJvcER3bkNvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tU1RVRkZTIFRPIEZJTFRFUiBTRUFSQ0ggT04gTUFQLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbiAgICBsZXQgc2VhcmNoQnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaEJ0XCIpOyAvL2xlIGJvdXR0b24gcmVjaGVyY2hlclxyXG4gICAgbGV0IHJhZGlvT3B0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoJ3NlYXJjaE9wdGlvbicpOyAvL2xlIHJhZGlvIGJ0IGNob3NlbiBieSB1c2VyIHRvIGZpbHRlciBieVxyXG4gICAgbGV0IHJlc05vdERGb3VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RGb3VuZCcpO1xyXG5cclxuICAgIC8qLi4uLmNvbnRyb2xzIHRoZSBwbGFjZWhvbGRlciBvZiB0aGUgc2VhcmNoIGJhciB3aGVuIHBpY2tpbmcgZGlmZmVyZW50IGZpbHRlcmluZyBvcHRpb25zIGZyb20gdGhlIHJhZGlvIGJ1dHRvbnMgLi4uLiovXHJcbiAgICBsZXQgcHJldiA9IG51bGw7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhZGlvT3B0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgcmFkaW9PcHRbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vKHByZXYpID8gY29uc29sZS5sb2cocHJldi52YWx1ZSk6IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzICE9PSBwcmV2KSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2ID0gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gcmFkaW9PcHQubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKHJhZGlvT3B0W2ldLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicmFkaW8gY2hlY2tlZCA9IFwiICsgcmFkaW9PcHRbaV0udmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImFwcGVsbGF0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS5wbGFjZWhvbGRlciA9ICdFbnRyZXogdW4gbm9tIGRcXCdhcHBlbGxhdGlvbic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNvdWxldXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFF1ZXJ5XCIpLnBsYWNlaG9sZGVyID0gJ0VudHJleiB1bmUgY291bGV1cic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImNlcGFnZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoUXVlcnlcIikucGxhY2Vob2xkZXIgPSAnRW50cmV6IHVuIG5vbSBkZSBjw6lwYWdlJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy52YWx1ZSlcclxuICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4qL1xyXG5cclxuICAgICAgICBzZWFyY2hCdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsYXllckdyb3VwLmNsZWFyTGF5ZXJzKCk7XHJcbiAgICAgICAgICAgIGxldCBwcyA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgcCA9IHt9O1xyXG4gICAgICAgICAgICBsZXQgc2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hRdWVyeVwiKS52YWx1ZTsgLy9jZSBxdSdhIGVjcml0IGwndXRpbGlzYXRldXIgZGFucyBsYSBiYXJyZSBkZSByZWNoZXJjaGVcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYWRpb09wdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmdldChcImh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvd2luZXNcIiwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGlvT3B0W2ldLnZhbHVlID09PSBcImFwcGVsbGF0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiREFUQVtpXSA9IFwiICsgZGF0YVtpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBvYmouZGVzaWduYXRpb24ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2gudG9Mb3dlckNhc2UoKS50cmltKCkgPT0gbmFtZS50b0xvd2VyQ2FzZSgpLnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLm5hbWUgPSBvYmoucHJvZHVjZXIubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubGF0ID0gb2JqLnByb2R1Y2VyLmxhdGl0dWRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sYXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxvbmcgPSBvYmoucHJvZHVjZXIubG9uZ2l0dWRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sb25nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHMucHVzaChwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3BzW2ldLmxhdCwgcHNbaV0ubG9uZ10pLmFkZFRvKGxheWVyR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLmJpbmRQb3B1cChcIjxhIGhyZWY9Jy9pbmZvX3dpbmVyeSc+PGI+RG9tYWluZTwvYj48YnI+XCIgKyBwc1tpXS5uYW1lICsgXCI8L2E+XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNOb3RERm91bmQuaW5uZXJUZXh0ID0gXCJQYXMgZGUgcsOpc3VsdGF0cy5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYWRpb09wdFtpXS52YWx1ZSA9PT0gXCJjb3VsZXVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IG9iai5jb2xvci5jb2xvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiQ09MT1IgPSBcIiArIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2gudG9Mb3dlckNhc2UoKS50cmltKCkgPT0gY29sb3IudG9Mb3dlckNhc2UoKS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5uYW1lID0gb2JqLnByb2R1Y2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuYW1lIGZvdW5kID0gXCIgKyBwLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxhdCA9IG9iai5wcm9kdWNlci5sYXRpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubGF0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5sb25nID0gb2JqLnByb2R1Y2VyLmxvbmdpdHVkZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubG9uZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnB1c2gocCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtwc1tpXS5sYXQsIHBzW2ldLmxvbmddKS5hZGRUbyhsYXllckdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5iaW5kUG9wdXAoXCI8YSBocmVmPScvaW5mb193aW5lcnknPjxiPkRvbWFpbmU8L2I+PGJyPlwiICsgcHNbaV0ubmFtZSArIFwiPC9hPlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFkaW9PcHRbaV0udmFsdWUgPT09IFwiY2VwYWdlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YXJpZXR5ID0gb2JqLnZhcmlldHkubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2gudG9Mb3dlckNhc2UoKS50cmltKCkgPT0gdmFyaWV0eS50b0xvd2VyQ2FzZSgpLnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLm5hbWUgPSBvYmoucHJvZHVjZXIubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5hbWUgZm91bmQgPSBcIiArIHAubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubGF0ID0gb2JqLnByb2R1Y2VyLmxhdGl0dWRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sYXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmxvbmcgPSBvYmoucHJvZHVjZXIubG9uZ2l0dWRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmFtZSBmb3VuZCA9IFwiICsgcC5sb25nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHMucHVzaChwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gTC5tYXJrZXIoW3BzW2ldLmxhdCwgcHNbaV0ubG9uZ10pLmFkZFRvKGxheWVyR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLmJpbmRQb3B1cChcIjxhIGhyZWY9Jy9pbmZvX3dpbmVyeSc+PGI+RG9tYWluZTwvYj48YnI+XCIgKyBwc1tpXS5uYW1lICsgXCI8L2E+XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuLy8gVGhlIExlYWZsZXQgTC5NYXAgY2xhc3MgcHJvdmlkZXMgdGhlIGZpdEJvdW5kcyBtZXRob2QgdG8gem9vbSBhIG1hcCB0byBjb250YWluIGEgcmVjdGFuZ3VsYXIgYm91bmRpbmcgYm94LlxyXG4vLyBUaGUgTC5sYXRMbmdCb3VuZHMgdXRpbGl0eSBmdW5jdGlvbiBjcmVhdGVzIGEgYm91bmRpbmcgYm94IG9iamVjdCBmcm9tIGFuIGFycmF5IG9mIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZXMuXHJcbi8vIFdpdGggYSBzaW5nbGUgbWFya2VyLCBob3dldmVyLCB3ZSBvbmx5IGhhdmUgb25lIGxhdGl0dWRlIGFuZCBsb25naXR1ZGUgY29vcmRpbmF0ZSBmcm9tIHdoaWNoIHRvIGNyZWF0ZSB0aGUgYm91bmRpbmcgYm94LlxyXG4vLyBUaGUgc29sdXRpb24gaXMgdG8gY3JlYXRlIGEgc2luZ2xlLWVsZW1lbnQgYXJyYXkgY29udGFpbmluZyB0aGUgbGF0aXR1ZGUgYW5kIGxvbmdpdHVkZSBjb29yZGluYXRlIG9mIHRoZSBtYXJrZXIuXHJcblxyXG4vLyBUaGUgZm9sbG93aW5nIGZ1bmN0aW9uIGNlbnRlcnMgYW5kIHpvb21zIGEgbGVhZmxldCBtYXAgb24gYSBzaW5nbGUgbWFya2VyLiBMaW5lIDIgY3JlYXRlcyB0aGUgc2luZ2xlLWVsZW1lbnQgYXJyYXkgY29udGFpbmluZ1xyXG4vLyB0aGUgbGF0aXR1ZGUgYW5kIGxvbmdpdHVkZSBjb29yZGluYXRlIG9mIHRoZSBtYXJrZXIuIExpbmUgMyBjcmVhdGVzIHRoZSBib3VuZGluZyBib3ggdGhhdCBlbmNsb3NlcyB0aGUgbWFya2Vy4oCZcyBsb2NhdGlvbi4gRmluYWxseSxcclxuLy8gbGluZSA0IHpvb21zIHRoZSBtYXAgdG8gZW5jbG9zZSB0aGUgYm91bmRpbmcgYm94LlxyXG5cclxuLy8gZnVuY3Rpb24gY2VudGVyTGVhZmxldE1hcE9uTWFya2VyKG1hcCwgbWFya2VyKSB7XHJcbi8vICAgICB2YXIgbGF0TG5ncyA9IFsgbWFya2VyLmdldExhdExuZygpIF07XHJcbi8vICAgICB2YXIgbWFya2VyQm91bmRzID0gTC5sYXRMbmdCb3VuZHMobGF0TG5ncyk7XHJcbi8vICAgICBtYXAuZml0Qm91bmRzKG1hcmtlckJvdW5kcyk7XHJcbi8vIH1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==